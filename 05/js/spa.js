!function(e,t,n,i){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e,t=t&&t.hasOwnProperty("default")?t.default:t,n=n&&n.hasOwnProperty("default")?n.default:n,i=i&&i.hasOwnProperty("default")?i.default:i;!function(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css","top"===n&&i.firstChild?i.insertBefore(a,i.firstChild):i.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}(".bmpp-curtains{background-color:#fff;position:fixed;z-index:1000;top:0;bottom:0;left:0;right:0}.bmpp-uiLayout{display:-webkit-box;display:-ms-flexbox;display:flex;width:100vw;height:100vh}.bmpp-sidePane{-webkit-box-ordinal-group:1;-ms-flex-order:0;order:0;width:14vw;min-width:208px;min-width:13rem;border-left:1px solid rgba(34,36,38,.15);border-right:1px solid rgba(34,36,38,.15);overflow-y:hidden}.bmpp-sidePane_menuItem{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;padding:1em 1.5em!important;border-bottom:1px solid rgba(34,36,38,.15);border-right:.3em solid transparent!important;cursor:pointer}.bmpp-sidePane_menuItem--current{border-right:.3em solid rgba(34,36,38,.15)!important;background-color:hsla(0,0%,98%,.75)!important}.bmpp-sidePane_menuItem--hover,.bmpp-sidePane_menuItem--hover.bmpp-sidePane_menuItem--current{border-right:.3em solid #767676!important;background-color:hsla(0,0%,98%,.75)!important}.bmpp-sidePane_menuItem .icon{position:absolute;right:1em}.bmpp-sidePane_menuItem.disabled{cursor:auto}.bmpp-sidePane_searchButton{margin-left:.3em!important}.bmpp-main{display:-webkit-box;display:-ms-flexbox;display:flex;width:100vw;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;overflow-y:scroll;padding-bottom:3em}.bmpp-resultsOptionsPane,.bmpp-subcorpusPane{width:55em;margin:3em auto auto 6em!important}.bmpp-nearLabelIcon{margin:0;padding:0;position:absolute;right:.2em;top:.8em}.bmpp-resultsPane{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch}.bmpp-resultsPane_video{border-bottom:1px solid rgba(34,36,38,.15);background-color:#eee}.bmpp-resultsPane_results{overflow-y:scroll}.bmpp-queryPane{display:-webkit-box;display:-ms-flexbox;display:flex}.bmpp-query,.bmpp-queryPane{-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto}.bmpp-query{max-width:70em;padding:3em 7em 0 0;-webkit-box-ordinal-group:2;-ms-flex-order:1;order:1}.bmpp-queryTree{-webkit-box-ordinal-group:1;-ms-flex-order:0;order:0;width:9em}.bmpp-queryElement{min-height:10em}.bmpp-queryTreeHandles{position:absolute;right:auto;left:100%;top:.45em;width:6em;padding-left:1em}.bmpp-queryTreeHandles .ui.icon{cursor:pointer}.bmpp-queryTreeHandles.bmpp-queryTreeHandles2{left:calc(100% + 1em)}.bmpp-queryDistances{margin:1em auto!important;position:relative}.bmpp-queryDistances--toOtherElement{margin-top:3em!important}.bmpp-queryDistances .bmpp-queryDistance{min-height:4em}.bmpp-queryDistances .bmpp-queryDistance .ui.form{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-align:baseline;-ms-flex-align:baseline;align-items:baseline}.bmpp-queryDistances .bmpp-queryDistance .ui.form .field{margin-right:1em}.bmpp-queryDistances .bmpp-queryDistance .ui.form .field.bmpp-number{min-width:8em!important;max-width:9em!important}.bmpp-queryDistances .bmpp-queryDistance .ui.form .field.bmpp-units{width:8em!important}.bmpp-queryDistances .bmpp-queryDistance .ui.form .field.bmpp-points{width:14em!important}.bmpp-queryDistances .bmpp-queryDistance .ui.form .bmpp-units .text{border-bottom:1px dashed grey!important}.bmpp-queryDistances .bmpp-queryDistance .ui.form input[type=number]{width:6em!important}.bmpp-queryDistances .bmpp-queryDistance .ui.form .ui.selection.dropdown{height:2em!important;padding-top:.5em!important}.bmpp-queryDistances .bmpp-queryDistanceHelp{position:absolute;top:1em!important;right:.5em!important}.bmpp-subcorpusForm{height:12em}.bmpp-subcorpusForm header{cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.bmpp-subcorpusForm .ui.form{-webkit-column-count:auto!important;-webkit-column-width:10rem!important;columns:10rem!important}.bmpp-unitGroups{list-style:none;margin:0;padding:0}.bmpp-unitGroups li{font-style:italic;margin:0;-webkit-column-break-inside:avoid;break-inside:avoid}.bmpp-units{list-style:none;margin:.5em 0 1.5em;padding:0}.bmpp-units li{font-style:normal;line-height:1.5em;cursor:pointer}.bmpp-units li .unit{border-bottom:1px dotted #2185d0;color:#2185d0}.bmpp-units li .unitSelectionContainer{padding:0 .5em .2em}.bmpp-units li.active .unit{border-bottom:none;color:#fff}.bmpp-units li.active .unitSelectionContainer{background-color:#2185d0}.bmpp-channelSlug{width:6em!important}.bmpp-editUrl{font-size:smaller;border-bottom:1px dotted #2185d0;color:#2185d0;cursor:pointer}.bmpp-negativeNode{padding-top:3.4em!important}");"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function a(e,t){return e(t={exports:{}},t.exports),t.exports}var r=1e3,s=60*r,o=60*s,l=24*o,c=7*l,d=365.25*l,u=function(e,t){t=t||{};var n=typeof e;if("string"===n&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\-?\d?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*d;case"weeks":case"week":case"w":return n*c;case"days":case"day":case"d":return n*l;case"hours":case"hour":case"hrs":case"hr":case"h":return n*o;case"minutes":case"minute":case"mins":case"min":case"m":return n*s;case"seconds":case"second":case"secs":case"sec":case"s":return n*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}(e);if("number"===n&&!1===isNaN(e))return t.long?function(e){var t=Math.abs(e);if(t>=l)return p(e,t,l,"day");if(t>=o)return p(e,t,o,"hour");if(t>=s)return p(e,t,s,"minute");if(t>=r)return p(e,t,r,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=l)return Math.round(e/l)+"d";if(t>=o)return Math.round(e/o)+"h";if(t>=s)return Math.round(e/s)+"m";if(t>=r)return Math.round(e/r)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function p(e,t,n,i){var a=t>=1.5*n;return Math.round(e/n)+" "+i+(a?"s":"")}var h=function(e){function t(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return n.colors[Math.abs(t)%n.colors.length]}function n(e){let r;function s(...e){if(!s.enabled)return;const t=s,i=Number(new Date),a=i-(r||i);t.diff=a,t.prev=r,t.curr=i,r=i,e[0]=n.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let o=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(i,a)=>{if("%%"===i)return i;o++;const r=n.formatters[a];if("function"==typeof r){const n=e[o];i=r.call(t,n),e.splice(o,1),o--}return i}),n.formatArgs.call(t,e),(t.log||n.log).apply(t,e)}return s.namespace=e,s.enabled=n.enabled(e),s.useColors=n.useColors(),s.color=t(e),s.destroy=i,s.extend=a,"function"==typeof n.init&&n.init(s),n.instances.push(s),s}function i(){const e=n.instances.indexOf(this);return-1!==e&&(n.instances.splice(e,1),!0)}function a(e,t){return n(this.namespace+(void 0===t?":":t)+e)}function r(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return n.debug=n,n.default=n,n.coerce=function(e){return e instanceof Error?e.stack||e.message:e},n.disable=function(){const e=[...n.names.map(r),...n.skips.map(r).map(e=>"-"+e)].join(",");return n.enable(""),e},n.enable=function(e){let t;n.save(e),n.names=[],n.skips=[];const i=("string"==typeof e?e:"").split(/[\s,]+/),a=i.length;for(t=0;t<a;t++)i[t]&&("-"===(e=i[t].replace(/\*/g,".*?"))[0]?n.skips.push(new RegExp("^"+e.substr(1)+"$")):n.names.push(new RegExp("^"+e+"$")));for(t=0;t<n.instances.length;t++){const e=n.instances[t];e.enabled=n.enabled(e.namespace)}},n.enabled=function(e){if("*"===e[e.length-1])return!0;let t,i;for(t=0,i=n.skips.length;t<i;t++)if(n.skips[t].test(e))return!1;for(t=0,i=n.names.length;t<i;t++)if(n.names[t].test(e))return!0;return!1},n.humanize=u,Object.keys(e).forEach(t=>{n[t]=e[t]}),n.instances=[],n.names=[],n.skips=[],n.formatters={},n.selectColor=t,n.enable(n.load()),n},m=a(function(e,t){t.log=function(...e){return"object"==typeof console&&console.log&&console.log(...e)},t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let i=0,a=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(i++,"%c"===e&&(a=i))}),t.splice(a,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports=h(t);const{formatters:n}=e.exports;n.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});m.log,m.formatArgs,m.save,m.load,m.useColors,m.storage,m.colors,m("bumppo:log");m.disable();var b=a(function(e,t){e.exports=function(){var e=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)},t=m,n=o,i=function(e){return l(o(e))},a=l,r=h,s=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^()])+)\\))?|\\(((?:\\\\.|[^()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function o(e){for(var t,n=[],i=0,a=0,r="";null!=(t=s.exec(e));){var o=t[0],l=t[1],c=t.index;if(r+=e.slice(a,c),a=c+o.length,l)r+=l[1];else{r&&(n.push(r),r="");var u=t[2],p=t[3],h=t[4],m=t[5],b=t[6],f=t[7],v="+"===b||"*"===b,y="?"===b||"*"===b,g=u||"/",w=h||m||(f?".*":"[^"+g+"]+?");n.push({name:p||i++,prefix:u||"",delimiter:g,optional:y,repeat:v,pattern:d(w)})}}return a<e.length&&(r+=e.substr(a)),r&&n.push(r),n}function l(t){for(var n=new Array(t.length),i=0;i<t.length;i++)"object"==typeof t[i]&&(n[i]=new RegExp("^"+t[i].pattern+"$"));return function(i){for(var a="",r=i||{},s=0;s<t.length;s++){var o=t[s];if("string"!=typeof o){var l,c=r[o.name];if(null==c){if(o.optional)continue;throw new TypeError('Expected "'+o.name+'" to be defined')}if(e(c)){if(!o.repeat)throw new TypeError('Expected "'+o.name+'" to not repeat, but received "'+c+'"');if(0===c.length){if(o.optional)continue;throw new TypeError('Expected "'+o.name+'" to not be empty')}for(var d=0;d<c.length;d++){if(l=encodeURIComponent(c[d]),!n[s].test(l))throw new TypeError('Expected all "'+o.name+'" to match "'+o.pattern+'", but received "'+l+'"');a+=(0===d?o.prefix:o.delimiter)+l}}else{if(l=encodeURIComponent(c),!n[s].test(l))throw new TypeError('Expected "'+o.name+'" to match "'+o.pattern+'", but received "'+l+'"');a+=o.prefix+l}}else a+=o}return a}}function c(e){return e.replace(/([.+*?=^!:${}()[\]|\/])/g,"\\$1")}function d(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function u(e,t){return e.keys=t,e}function p(e){return e.sensitive?"":"i"}function h(e,t){for(var n=(t=t||{}).strict,i=!1!==t.end,a="",r=e[e.length-1],s="string"==typeof r&&/\/$/.test(r),o=0;o<e.length;o++){var l=e[o];if("string"==typeof l)a+=c(l);else{var d=c(l.prefix),u=l.pattern;l.repeat&&(u+="(?:"+d+u+")*"),u=l.optional?d?"(?:"+d+"("+u+"))?":"("+u+")?":d+"("+u+")",a+=u}}return n||(a=(s?a.slice(0,-2):a)+"(?:\\/(?=$))?"),a+=i?"$":n&&s?"":"(?=\\/|$)",new RegExp("^"+a,p(t))}function m(t,n,i){return e(n=n||[])?i||(i={}):(i=n,n=[]),t instanceof RegExp?function(e,t){var n=e.source.match(/\((?!\?)/g);if(n)for(var i=0;i<n.length;i++)t.push({name:i,prefix:null,delimiter:null,optional:!1,repeat:!1,pattern:null});return u(e,t)}(t,n):e(t)?function(e,t,n){for(var i=[],a=0;a<e.length;a++)i.push(m(e[a],t,n).source);return u(new RegExp("(?:"+i.join("|")+")",p(n)),t)}(t,n,i):function(e,t,n){for(var i=o(e),a=h(i,n),r=0;r<i.length;r++)"string"!=typeof i[r]&&t.push(i[r]);return u(a,t)}(t,n,i)}t.parse=n,t.compile=i,t.tokensToFunction=a,t.tokensToRegExp=r;var b,f="undefined"!=typeof document,v="undefined"!=typeof window,y="undefined"!=typeof history,g="undefined"!=typeof process,w=f&&document.ontouchstart?"touchstart":"click",x=v&&!(!window.history.location&&!window.location);function C(){this.callbacks=[],this.exits=[],this.current="",this.len=0,this._decodeURLComponents=!0,this._base="",this._strict=!1,this._running=!1,this._hashbang=!1,this.clickHandler=this.clickHandler.bind(this),this._onpopstate=this._onpopstate.bind(this)}function k(e,t){if("function"==typeof e)return k.call(this,"*",e);if("function"==typeof t)for(var n=new P(e,null,this),i=1;i<arguments.length;++i)this.callbacks.push(n.middleware(arguments[i]));else"string"==typeof e?this["string"==typeof t?"redirect":"show"](e,t):this.start(e)}function N(e,t,n){var i=this.page=n||k,a=i._window,r=i._hashbang,s=i._getBase();"/"===e[0]&&0!==e.indexOf(s)&&(e=s+(r?"#!":"")+e);var o=e.indexOf("?");if(this.canonicalPath=e,this.path=e.replace(s,"")||"/",r&&(this.path=this.path.replace("#!","")||"/"),this.title=f&&a.document.title,this.state=t||{},this.state.path=e,this.querystring=~o?i._decodeURLEncodedURIComponent(e.slice(o+1)):"",this.pathname=i._decodeURLEncodedURIComponent(~o?e.slice(0,o):e),this.params={},this.hash="",!r){if(!~this.path.indexOf("#"))return;var l=this.path.split("#");this.path=this.pathname=l[0],this.hash=i._decodeURLEncodedURIComponent(l[1])||"",this.querystring=this.querystring.split("#")[0]}}function P(e,n,i){this.page=i||_;var a=n||{};a.strict=a.strict||i._strict,this.path="*"===e?"(.*)":e,this.method="GET",this.regexp=t(this.path,this.keys=[],a)}C.prototype.configure=function(e){var t=e||{};this._window=t.window||v&&window,this._decodeURLComponents=!1!==t.decodeURLComponents,this._popstate=!1!==t.popstate&&v,this._click=!1!==t.click&&f,this._hashbang=!!t.hashbang;var n=this._window;this._popstate?n.addEventListener("popstate",this._onpopstate,!1):v&&n.removeEventListener("popstate",this._onpopstate,!1),this._click?n.document.addEventListener(w,this.clickHandler,!1):f&&n.document.removeEventListener(w,this.clickHandler,!1),this._hashbang&&v&&!y?n.addEventListener("hashchange",this._onpopstate,!1):v&&n.removeEventListener("hashchange",this._onpopstate,!1)},C.prototype.base=function(e){if(0===arguments.length)return this._base;this._base=e},C.prototype._getBase=function(){var e=this._base;if(e)return e;var t=v&&this._window&&this._window.location;return v&&this._hashbang&&t&&"file:"===t.protocol&&(e=t.pathname),e},C.prototype.strict=function(e){if(0===arguments.length)return this._strict;this._strict=e},C.prototype.start=function(e){if(this.configure(e),!1!==e.dispatch){var t;if(this._running=!0,x){var n=this._window,i=n.location;t=this._hashbang&&~i.hash.indexOf("#!")?i.hash.substr(2)+i.search:this._hashbang?i.search+i.hash:i.pathname+i.search+i.hash}this.replace(t,null,!0,e.dispatch)}},C.prototype.stop=function(){if(this._running){this.current="",this.len=0,this._running=!1;var e=this._window;this._click&&e.document.removeEventListener(w,this.clickHandler,!1),v&&e.removeEventListener("popstate",this._onpopstate,!1),v&&e.removeEventListener("hashchange",this._onpopstate,!1)}},C.prototype.show=function(e,t,n,i){var a=new N(e,t,this),r=this.prevContext;return this.prevContext=a,this.current=a.path,!1!==n&&this.dispatch(a,r),!1!==a.handled&&!1!==i&&a.pushState(),a},C.prototype.back=function(e,t){var n=this;if(this.len>0){var i=this._window;y&&i.history.back(),this.len--}else e?setTimeout(function(){n.show(e,t)}):setTimeout(function(){n.show(n._getBase(),t)})},C.prototype.redirect=function(e,t){var n=this;"string"==typeof e&&"string"==typeof t&&k.call(this,e,function(e){setTimeout(function(){n.replace(t)},0)}),"string"==typeof e&&void 0===t&&setTimeout(function(){n.replace(e)},0)},C.prototype.replace=function(e,t,n,i){var a=new N(e,t,this),r=this.prevContext;return this.prevContext=a,this.current=a.path,a.init=n,a.save(),!1!==i&&this.dispatch(a,r),a},C.prototype.dispatch=function(e,t){var n=0,i=0,a=this;function r(){var t=a.callbacks[n++];if(e.path===a.current)return t?void t(e,r):function(e){if(!e.handled){var t=this._window;(this._hashbang?x&&this._getBase()+t.location.hash.replace("#!",""):x&&t.location.pathname+t.location.search)!==e.canonicalPath&&(this.stop(),e.handled=!1,x&&(t.location.href=e.canonicalPath))}}.call(a,e);e.handled=!1}t?function e(){var n=a.exits[i++];if(!n)return r();n(t,e)}():r()},C.prototype.exit=function(e,t){if("function"==typeof e)return this.exit("*",e);for(var n=new P(e,null,this),i=1;i<arguments.length;++i)this.exits.push(n.middleware(arguments[i]))},C.prototype.clickHandler=function(e){if(1===this._which(e)&&!(e.metaKey||e.ctrlKey||e.shiftKey||e.defaultPrevented)){var t=e.target,n=e.path||(e.composedPath?e.composedPath():null);if(n)for(var i=0;i<n.length;i++)if(n[i].nodeName&&"A"===n[i].nodeName.toUpperCase()&&n[i].href){t=n[i];break}for(;t&&"A"!==t.nodeName.toUpperCase();)t=t.parentNode;if(t&&"A"===t.nodeName.toUpperCase()){var a="object"==typeof t.href&&"SVGAnimatedString"===t.href.constructor.name;if(!t.hasAttribute("download")&&"external"!==t.getAttribute("rel")){var r=t.getAttribute("href");if((this._hashbang||!this._samePath(t)||!t.hash&&"#"!==r)&&!(r&&r.indexOf("mailto:")>-1)&&(a?!t.target.baseVal:!t.target)&&(a||this.sameOrigin(t.href))){var s=a?t.href.baseVal:t.pathname+t.search+(t.hash||"");s="/"!==s[0]?"/"+s:s,g&&s.match(/^\/[a-zA-Z]:\//)&&(s=s.replace(/^\/[a-zA-Z]:\//,"/"));var o=s,l=this._getBase();0===s.indexOf(l)&&(s=s.substr(l.length)),this._hashbang&&(s=s.replace("#!","")),(!l||o!==s||x&&"file:"===this._window.location.protocol)&&(e.preventDefault(),this.show(o))}}}}},C.prototype._onpopstate=(b=!1,v?(f&&"complete"===document.readyState?b=!0:window.addEventListener("load",function(){setTimeout(function(){b=!0},0)}),function(e){if(b)if(e.state){var t=e.state.path;this.replace(t,e.state)}else if(x){var n=this._window.location;this.show(n.pathname+n.search+n.hash,void 0,void 0,!1)}}):function(){}),C.prototype._which=function(e){return null==(e=e||v&&this._window.event).which?e.button:e.which},C.prototype._toURL=function(e){var t=this._window;if("function"==typeof URL&&x)return new URL(e,t.location.toString());if(f){var n=t.document.createElement("a");return n.href=e,n}},C.prototype.sameOrigin=function(e){if(!e||!x)return!1;var t=this._toURL(e),n=this._window,i=n.location;return i.protocol===t.protocol&&i.hostname===t.hostname&&i.port===t.port},C.prototype._samePath=function(e){if(!x)return!1;var t=this._window,n=t.location;return e.pathname===n.pathname&&e.search===n.search},C.prototype._decodeURLEncodedURIComponent=function(e){return"string"!=typeof e?e:this._decodeURLComponents?decodeURIComponent(e.replace(/\+/g," ")):e},N.prototype.pushState=function(){var e=this.page,t=e._window,n=e._hashbang;e.len++,y&&t.history.pushState(this.state,this.title,n&&"/"!==this.path?"#!"+this.path:this.canonicalPath)},N.prototype.save=function(){var e=this.page;y&&"file:"!==e._window.location.protocol&&e._window.history.replaceState(this.state,this.title,e._hashbang&&"/"!==this.path?"#!"+this.path:this.canonicalPath)},P.prototype.middleware=function(e){var t=this;return function(n,i){if(t.match(n.path,n.params))return e(n,i);i()}},P.prototype.match=function(e,t){var n=this.keys,i=e.indexOf("?"),a=~i?e.slice(0,i):e,r=this.regexp.exec(decodeURIComponent(a));if(!r)return!1;for(var s=1,o=r.length;s<o;++s){var l=n[s-1],c=this.page._decodeURLEncodedURIComponent(r[s]);void 0===c&&hasOwnProperty.call(t,l.name)||(t[l.name]=c)}return!0};var _=function e(){var t=new C;function n(){return k.apply(t,arguments)}return n.callbacks=t.callbacks,n.exits=t.exits,n.base=t.base.bind(t),n.strict=t.strict.bind(t),n.start=t.start.bind(t),n.stop=t.stop.bind(t),n.show=t.show.bind(t),n.back=t.back.bind(t),n.redirect=t.redirect.bind(t),n.replace=t.replace.bind(t),n.dispatch=t.dispatch.bind(t),n.exit=t.exit.bind(t),n.configure=t.configure.bind(t),n.sameOrigin=t.sameOrigin.bind(t),n.clickHandler=t.clickHandler.bind(t),n.create=e,Object.defineProperty(n,"len",{get:function(){return t.len},set:function(e){t.len=e}}),Object.defineProperty(n,"current",{get:function(){return t.current},set:function(e){t.current=e}}),n.Context=N,n.Route=P,n}(),S=_,q=_;return S.default=q,S}()});function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function y(e,t,n){return t&&v(e.prototype,t),n&&v(e,n),e}function g(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=e.depth(),a=w.levels;if(0==i)a=w.levels=[0],w.serialNumber=1;else{if(!(0===i||a instanceof Array))throw"Нарушена правильная работа функции линеаризации дерева";if(n)a.push(0);else if(a.length===i+1)a[a.length-1]+=1;else{var r=Math.max.apply(Math,g(a.slice(i)));a.splice(i),a[i]=r+1}}if(e.level(a.slice(-1)[0]),e.serialNumber(w.serialNumber),w.serialNumber+=1,t.push(e),e.childNodes().length>0)for(var s=0;s<e.childNodes().length;s++){t=w(e.childNodes()[s],t,0==s)}return t}for(var x={viewModel:{createViewModel:function(e,n){var a=function(e){var t=!0,n=!1,i=void 0;try{for(var a,r=e[Symbol.iterator]();!(t=(a=r.next()).done);t=!0){var s=a.value;s.svgSlug&&s.svgSlug.position()}}catch(e){n=!0,i=e}finally{try{t||null==r.return||r.return()}finally{if(n)throw i}}var o=!0,l=!1,c=void 0;try{for(var d,u=e.slice(1)[Symbol.iterator]();!(o=(d=u.next()).done);o=!0){var p=d.value;p.svgRelationLine&&p.svgRelationLine.redrawLine()}}catch(e){l=!0,c=e}finally{try{o||null==u.return||u.return()}finally{if(l)throw c}}},r=i.computed(function(){var t=w(e.queryTree,[]),n=!0,i=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done);n=!0)r.value.childNodes()}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return t});return r.subscribe(a),new MutationObserver(function(){return void 0!==a.timeoutID&&clearTimeout(a.timeoutID),a.timeoutID=setTimeout(function(){a(r())},30),!0}).observe(n.element,{childList:!0,subtree:!0,attributes:!1,characterData:!1,attributeOldValue:!1,characterDataOldValue:!1}),{linearizedQueryTree:r,svgDraw:t("svgQueryTree").size("100%","100%")}}},template:'\n\n  <div class="bmpp-queryPane">\n    <div class="bmpp-queryTree" id="'.concat("svgQueryTree",'">\n    </div>\n    <div class="bmpp-query" data-bind="foreach: linearizedQueryTree">\n\n      <query-node-relations params="node: $data, draw: $component.svgDraw"\n        data-bind="visible: $data.parentNode">\n      </query-node-relations>\n\n      <query-node params="node: $data, draw: $component.svgDraw"></query-node>\n\n    </div>\n  </div>\n\n')},C={viewModel:{createViewModel:function(e,t){for(var i=e.records,a=e.recordPhases,r={variation:"basic",delay:{show:400,hide:0},duration:400},s=[{html:"\n\n  <p>При выборе одного или нескольких вариантов поиск будет\n  вестись только по указанным записям. В&nbsp;настоящий момент\n  для поиска доступны 4 из 6 записей.</p>\n\n",selector:".bmpp-recordsHelp"},{html:"\n\n  <p>При выборе одного или нескольких вариантов поиск будет\n  вестись только по указанным этапам: рассказу, разговору или\n  пересказу.</p>\n\n",selector:".bmpp-recordsPhasesHelp"}],o=0;o<s.length;o++){var l=s[o],c=l.html,d=l.selector;r.html=c,n(t.element).find(d).popup(r)}return{records:i,recordPhases:a,subcorpusClearSelection:function(){i.areAllUnchecked()||i.clearSelection(),a.areAllUnchecked()||a.clearSelection()}}}},template:'\n\n  <h1 class="ui header">Область поиска</h1>\n  <div class="ui grid">\n    <div class="ten wide column" data-bind="with: records">\n      <div class="ui padded segment bmpp-subcorpusForm">\n        <div class="ui top attached large label">\n          <header data-bind="click: invertSelection">\n            Записи\n          </header>\n          <i class="disabled question circle outline icon\n                    bmpp-nearLabelIcon bmpp-recordsHelp"></i>\n        </div>\n\n        <div class="ui form" data-bind="foreach: fields">\n          <div class="field">\n            <bmpp-checkbox params="value: value, label: label,\n              disabled: disabled, tabindex: $index,\n              disabledTooltip: \'Запись пока не готова\'"></bmpp-checkbox>\n          </div>\n        </div>\n\n      </div>\n    </div>\n\n    <div class="six wide column" data-bind="with: recordPhases">\n      <div class="ui padded segment bmpp-subcorpusForm">\n        <div class="ui top attached large label">\n          <header data-bind="click: invertSelection">\n            Этапы записей\n          </header>\n          <i class="disabled question circle outline icon\n             bmpp-nearLabelIcon bmpp-recordsPhasesHelp"></i>\n        </div>\n        <form class="ui form" data-bind="foreach: fields">\n          <div class="field">\n            <bmpp-checkbox params="value: value, label: label,\n              tabindex: $index() + $root.subcorpus.records.fields.length">\n            </bmpp-checkbox>\n          </div>\n        </form>\n\n      </div>\n    </div>\n\n    <div>\n      <button class="ui small button three wide column"\n        data-bind="click: subcorpusClearSelection">Очистить</button>\n      <button class="ui small button three wide column">Отмена</button>\n    </div>\n\n  </div>\n\n'},k=function(){function e(t,n,i){f(this,e);var a=this.drawCircle(t),r=this.drawText(t,i.serialNumber());this.draw=t,this.element=n,this.treeNode=i,this.svgText=r,this.svg=t.group().add(a).add(r),this.fineTune()}return y(e,[{key:"drawCircle",value:function(e){return e.circle(30).attr({fill:"none",stroke:"#aaa","stroke-width":1}).cx(15).cy(15)}},{key:"drawText",value:function(e,t){return e.text(String(t)).attr({fill:"#aaa"}).cx(15).cy(15)}},{key:"fineTune",value:function(){var e=this;this.position(),this.treeNode.serialNumber.subscribe(function(t){e.changeText(t)}),i.utils.domNodeDisposal.addDisposeCallback(this.element,function(){e.dispose()}),this.treeNode.svgSlug=this}},{key:"position",value:function(){var e=n(this.element).offset().top,t=n(this.element).parent().offset().top,i=Math.abs(e-t)+18;this.svg.x(83).y(i)}},{key:"changeText",value:function(e){this.svgText=this.svgText.text(String(e))}},{key:"dispose",value:function(){this.svg.remove(),this.svgText.remove()}}]),e}(),N=function(){function e(t,n,i){f(this,e),this.draw=t,this.element=n,this.treeNode=i,this.svg=this.drawLine(t,i),this.fineTune()}return y(e,[{key:"fineTune",value:function(){var e=this;i.utils.domNodeDisposal.addDisposeCallback(this.element,function(){e.dispose()}),this.treeNode.svgRelationLine=this}},{key:"drawLine",value:function(e,t){var n="";if(t.parentNode){var i=t.parentNode.svgSlug.svg;n="M ".concat(i.cx()," ").concat(i.cy()+15,"\n              L ").concat(i.cx()," ").concat(i.cy()+15)}return e.path(n).fill("none").stroke({color:"#aaa",width:1})}},{key:"redrawLine",value:function(){var t=this.treeNode.parentNode&&this.treeNode.parentNode.svgSlug,i=this.treeNode.svgSlug,a=this.treeNode.level,r=n(this.element).height();if(t&&i&&a){var s=e.calculatePath(t,i,a(),r);this.svg.plot(s)}}},{key:"dispose",value:function(){this.svg.remove()}}],[{key:"calculatePath",value:function(e,t,n,i){var a=e.svg,r=t.svg,s=15,o=i-45,l=n<3?n:2,c=n<3?0:n-2,d=67.5;return 0===n?"M ".concat(a.cx()," ").concat(a.cy()+s,"\n              L ").concat(r.cx()," ").concat(r.cy()-s):"M ".concat(a.cx()," ").concat(a.cy()+s,"\n              V ").concat(a.cy()+s+7.5,"\n              C ").concat(a.cx()," ").concat(a.cy()+s+7.5+45,"\n                ").concat(a.cx()-15-19.5*l-7.5*c," ").concat(a.cy()+s+7.5+d-45,"\n                ").concat(a.cx()-15-19.5*l-7.5*c," ").concat(a.cy()+s+7.5+d,"\n              V ").concat(r.cy()-s-o-d,"\n              C ").concat(r.cx()-15-19.5*l-7.5*c," ").concat(r.cy()-s-o-d+45,"\n                ").concat(r.cx()," ").concat(r.cy()-s-o-45,"\n                ").concat(r.cx()," ").concat(r.cy()-s-o,"\n              V ").concat(r.cy()-s)}}]),e}(),P={viewModel:{createViewModel:function(e,t){var i=e.node,a={variation:"basic",position:"bottom right",transition:"fade",delay:{show:1e3,hide:0},duration:400,onVisible:function(e){setTimeout(function(e){n(e).popup("hide")}.bind(this,e),1700)}};return new k(e.draw,t.element,i),n(document).ready(function(){var e=n(t.element);a.content="Добавить единицу поиска",e.find(".bmpp-addPositiveUnit").popup(a),a.content="Добавить отрицательную единицу поиска",e.find(".bmpp-addNegativeUnit").popup(a),e.find(".bmpp-negativeUnitHelp").popup({inline:!0})}),{node:i}}},template:'\n\n  <div class="bmpp-queryElement ui segment"\n    data-bind="css: { \'bmpp-negativeNode\': node.negative }">\n\n    <div class="bmpp-queryTreeHandles">\n\n      <i class="ui disabled green down arrow icon bmpp-addPositiveUnit"\n        data-bind="click: node.addChild.bind(node, false),\n          visible: !node.negative() && node.unitType() !== null"></i>\n\n      <i class="ui disabled red down arrow icon bmpp-addNegativeUnit"\n        data-bind="click: node.addChild.bind(node, true),\n          visible: !node.negative() && node.unitType() !== null"></i>\n\n      <i class="ui disabled grey close icon"\n        title="Удалить единицу поиска со всеми зависимостями"\n        data-bind="visible: node.depth() > 0,\n          click: function () {\n                   node.seppuku();\n                   $root.isQueryNew(true);\n                 }"></i>\n    </div>\n\n    <div class="ui top attached basic red label"\n      data-bind="visible: node.negative">\n      НЕТ\n      <i class="disabled grey question circle outline icon\n        bmpp-nearLabelIcon bmpp-negativeUnitHelp"></i>\n      <div class="ui basic popup hidden">\n        <header class="ui header">Отрицательное условие</header>\n\n        <p>При отрицательном условии ищутся контексты, в которых\n        <strong>нет</strong> единиц, обладающих указанными свойствами,\n        и располагающихся на указанном расстоянии.</p>\n\n        <p>Отрицательное условие всегда является терминальным: к ветке запроса,\n        заканчивающейся этой единицей, нельзя добавить еще одну единицу.</p>\n      </div>\n    </div>\n\n    <search-unit-choice params="node: node,\n      queryPartsNonReadiness: $root.queryPartsNonReadiness,\n      isQueryNew: $root.isQueryNew">\n    </search-unit-choice>\n\n  </div>\n\n'},_={viewModel:{createViewModel:function(e,t){var i=e.node,a=t.element,r={html:'\n\n  <header class="ui header">Условие на расстояние</header>\n\n  <p>В качестве условий можно по отдельности указывать интервалы расстояний\n  между началами (левыми границами) и концами (правыми границами) единиц.\n  Например, если задать условие «от&nbsp;−50 до&nbsp;100&nbsp;мс между началом\n  X и началом Y», будут найдены контексты, в которых левая граница\n  X располагается не левее, чем в&nbsp;50&nbsp;мс, и не правее, чем\n  в&nbsp;100&nbsp;мс, от левой границы Y.</p>\n\n  <p>Если для условия указано только одно значение, ограничения с другой\n  стороны не накладывается. Если не указано ни одно значение, это\n  интерпретируется как интервал «от&nbsp;0 до&nbsp;0». Значения задаются\n  в миллисекундах. Если X и Y являются единицам одного типа, между началом\n  X и концом Y можно задать расстояние в терминах единицы данного типа.</p>\n\n',variation:"basic fluid",setFluidWidth:!1,delay:{show:400,hide:0},duration:400,lastResort:!0,onShow:function(e){var t=n(e).popup("get popup");n(t).attr("style","width: 35em!important")}};return new N(e.draw,a,i),n(a).find(".bmpp-queryDistanceHelp").popup(r),n.initialize(".ui.dropdown",function(){n(this).dropdown()},{target:a}),{relations:i.relationsToParentNode,node:i}}},template:'\n\n  <div class="bmpp-queryDistances ui segments"\n    data-bind="css: { \'bmpp-queryDistances--toOtherElement\':\n                      $component.node.level() > 0 }">\n\n    \x3c!-- ko foreach: relations --\x3e\n      '.concat('\n\n  <div class="bmpp-queryDistance ui secondary segment">\n\n    <div class="ui tiny header" data-bind="visible: $index() === 0">\n      на расстоянии:\n    </div>\n\n    <div class="ui form" style="margin-bottom: -1em;">\n      <div class="bmpp-queryTreeHandles bmpp-queryTreeHandles2">\n        <i class="ui small disabled grey plus icon"\n          data-bind="visible: $index() === $component.relations().length - 1,\n                     click: childNode.addRelation.bind(childNode)">\n        </i>\n\n        <i class="ui small icon"\n          data-bind="visible: $index() !== $component.relations().length - 1">\n        </i>\n\n        <i class="ui small disabled grey close icon"\n          data-bind="visible: $index() !== 0,\n                   click: childNode.removeRelation.bind(childNode, $data)"></i>\n      </div>\n\n      <div class="inline field bmpp-number">\n        <label>от</label>\n        <input type="number" step="50" min="0" placeholder="0">\n      </div>\n\n      <div class="inline field bmpp-number">\n        <label>до</label>\n        <input type="number" step="50" min="0" placeholder="0">\n      </div>\n\n      <div class="inline field bmpp-units">\n        <div class="ui inline dropdown">\n          <div class="default text">миллисекунд</div>\n          <div class="menu">\n            <div class="item" data-value="ms">миллисекунд</div>\n            <div class="item" data-value="u">единиц</div>\n          </div>\n        </div>\n      </div>\n\n      <div class="inline field bmpp-points">\n        <div class="ui selection dropdown">\n          <input type="hidden" name="pp">\n          <label>между</label>\n          <i class="dropdown icon"></i>\n          <div class="default text">\n            началом\n            <div class="ui circular label"\n              data-bind="text: childNode.serialNumber"></div>\n          </div>\n          <div class="menu">\n            <div class="item" data-value="s">\n              началом\n              <div class="ui circular label"\n                data-bind="text: childNode.serialNumber"></div>\n            </div>\n            <div class="item" data-value="e">\n              концом\n              <div class="ui circular label"\n                data-bind="text: childNode.serialNumber"></div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class="inline field bmpp-points">\n        <div class="ui selection dropdown">\n          <input type="hidden" name="cp">\n          <label>и</label>\n          <i class="dropdown icon"></i>\n          <div class="default text">\n            началом\n            <div class="ui circular label"\n              data-bind="text: parentNode.serialNumber"></div>\n          </div>\n          <div class="menu">\n            <div class="item" data-value="s">\n              началом\n              <div class="ui circular label"\n                data-bind="text: parentNode.serialNumber"></div>\n            </div>\n            <div class="item" data-value="e">\n              концом\n              <div class="ui circular label"\n                data-bind="text: parentNode.serialNumber"></div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n  </div>\n\n','\n    \x3c!-- /ko --\x3e\n\n    <i class="ui disabled grey question circle outline icon\n              bmpp-queryDistanceHelp"></i>\n  </div>\n\n')},S={viewModel:{createViewModel:function(e,t){var i=t.element,a=e.value,r=e.disabled,s={onChange:function(){a(!a())}},o={content:e.disabledTooltip,variation:"basic",position:"right center",transition:"fade",delay:{show:500,hide:0},duration:400,onVisible:function(e){setTimeout(function(e){n(e).popup("hide")}.bind(this,e),1700)}};return r?n(i).popup(o):n(i).checkbox(s),{disabled:r,label:e.label,tabindex:e.tabindex,value:a}}},template:'\n\n  <div class="ui checkbox" data-bind="css: { disabled: disabled }">\n    <input type="checkbox" class="hidden"\n      data-bind="checked: value, attr: { tabindex: tabindex }">\n    <label data-bind="text: label"></label>\n  </div>\n\n'},q=[{id:"voc",name:"Вокальные действия",unitsHeader:"Вокальные единицы",color:"red",types:[{name:"Верхний уровень сегментации",types:[{name:"Элементарная дискурсивная единица (ЭДЕ)",abbr:"ЭДЕ",id:"u_vEDU"},{name:"Изолированный смех",id:"u_vLaughLine"},{name:"Изолированный кластер заполненных пауз",id:"u_vFilledLine"},{name:"Самостоятельное неречевое вокальное явление",id:"u_vNonVerbalLine"}]},{name:"Нижний уровень сегментации",types:[{name:"Слово",id:"u_vWord"},{name:"Cмех",id:"u_vLaughSegm"},{name:"Заполненная пауза",id:"u_vFilledSegm"},{name:"Пауза со вдохом",id:"u_vHPause"},{name:"Неречевое вокальное действие",id:"u_vOtherSegm"},{name:"Абсолютная пауза",id:"u_v--AbsolutePause"}]},{name:"Параллельный уровень сегментации",types:[{name:"Вокальное явление, накладывающееся на речь",id:"u_vCollat"}]}]},{id:"ocul",name:"Направление взора",unitsHeader:"Единицы окуломоторного канала",color:"orange",types:[{name:"Фиксация",id:"u_oFixation"}]},{id:"facial",name:"Мимика",unitsHeader:"Единицы канала мимики",color:"yellow",disabled:!0,types:[]},{id:"ceph",name:"Жесты головы",unitsHeader:"Единицы цефалической жестикуляции",color:"green",types:[{name:"Базовый уровень сегментации",types:[{name:"Движение",id:"u_c1"},{name:"Неподвижность",id:"u_c2"}]},{name:"Дополнительный уровень сегментации",types:[{name:"Жест",id:"u_c3"},{name:"Адаптор",id:"u_c4"},{name:"Смена позы",id:"u_c5"}]}]},{id:"manu",name:"Жесты рук",unitsHeader:"Единицы мануальной жестикуляции",color:"teal",types:[{name:"Первый уровень сегментации",types:[{name:"Движение",id:"u_m1"},{name:"Неподвижность",id:"u_m2"}]},{name:"Второй уровень сегментации",types:[{name:"Жест",id:"u_m3"},{name:"Адаптор",id:"u_m4"},{name:"Смена позы",id:"u_m5"}]},{name:"Третий уровень сегментации",types:[{name:"Мануальная поза",id:"u_m6"},{name:"Фаза перехода",id:"u_m7"},{name:"Двигательная цепочка",id:"u_m8"},{name:"Жестовая цепочка",id:"u_m9"}]}]},{id:"torso",name:"Движения тела",unitsHeader:"Единицы жестикуляции тела",color:"blue",disabled:!0,types:[]},{id:"prox",name:"Проксемика",unitsHeader:"Единицы проксемики",color:"violet",disabled:!0,types:[]}],F=function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;f(this,e),this.id=t.id,this.name=t.name,this.channel=n,this.group=i,this.hasAbbr=Boolean(t.abbr),this.abbr=t.abbr||""},E=function(){function e(t,n){f(this,e),this.name=t.name,this.channel=n,this.units=[],this.totalNumberOfUnits=0,this.populateUnits(t)}return y(e,[{key:"populateUnits",value:function(e){var t=!0,n=!1,i=void 0;try{for(var a,r=e.types[Symbol.iterator]();!(t=(a=r.next()).done);t=!0){var s=a.value;this.units.push(new F(s,this.channel,this)),this.totalNumberOfUnits+=1}}catch(e){n=!0,i=e}finally{try{t||null==r.return||r.return()}finally{if(n)throw i}}}}]),e}(),O=function(){function e(t){f(this,e),this.id=t.id,this.name=t.name||"",this.unitsHeader=t.unitsHeader||"",this.color=t.color,this.disabled=t.disabled,this.groups=[],this.units=[],this.totalNumberOfUnits=0,this.populateGroupsAndUnits(t)}return y(e,[{key:"populateGroupsAndUnits",value:function(e){var t=!0,n=!1,i=void 0;try{for(var a,r=e.types[Symbol.iterator]();!(t=(a=r.next()).done);t=!0){var s=a.value;if(s.types){var o=new E(s,this);this.groups.push(o),this.totalNumberOfUnits+=o.totalNumberOfUnits}else this.units.push(new F(s,this)),this.totalNumberOfUnits+=1}}catch(e){n=!0,i=e}finally{try{t||null==r.return||r.return()}finally{if(n)throw i}}}},{key:"getSingleUnit",value:function(){if(1===this.totalNumberOfUnits){var e,t=(e=this.units.slice()).concat.apply(e,g(this.groups.map(function(e){return e.units.slice()})));if(t.length>0)return t[0]}return null}}]),e}(),T=[],U=0;U<q.length;U++){var R=q[U];T.push(new O(R))}var A='\n\n  <header class="ui header">Единицы поиска</header>\n\n  <p>Чтобы выбрать единицу поиска, сначала укажите область разметки\n  в верхнем меню, а затем нажмите на нужный вам тип единицы.</p>\n\n',L='\n\n  <li data-bind="click: $component.iHaveChosenUnitType.bind($data),\n                 css: { active: $component.node.unitType() &&\n                                $component.node.unitType().id === id }">\n    <span class="unitSelectionContainer">\n      <span class="unit" data-bind="text: name"></span>\n    </span>\n  </li>\n\n',D='\n\n  <div>\n    \x3c!-- ko foreach: channelViewModels --\x3e\n    <button class="ui button bmpp-channelSlug"\n      data-bind="css: buttonCSS, text: channel.id,\n        popup: tooltip, popupOpts: channelPopupOpts,\n        popupAdditionalShowOnClick: disabled,\n        event: { click: onClick, mouseover: onMouseOver,\n                 mouseout: onMouseOut }">\n    </button>\n    \x3c!-- /ko --\x3e\n\n    <i class="disabled grey question circle outline icon bmpp-channelsHelp"\n      data-bind="popup: channelsHelp.html, popupOpts: channelsHelp.opts"></i>\n  </div>\n\n  \x3c!-- ko if: activeChannel --\x3e\n  <div data-bind="with: activeChannel" style="margin-top: 2em">\n    <header class="ui tiny header"\n      data-bind="text: channel.unitsHeader"></header>\n    <div style="column-count: 2">\n\n      \x3c!-- ko if: channel.groups --\x3e\n      <ul class="bmpp-unitGroups" data-bind="foreach: channel.groups">\n        <li>\n          <header data-bind="text: name"></header>\n          <ul class="bmpp-units" data-bind="foreach: units">\n            '.concat(L,'\n          </ul>\n        </li>\n      </ul>\n      \x3c!-- /ko --\x3e\n\n      \x3c!-- ko if: channel.units --\x3e\n      <ul class="bmpp-units" data-bind="foreach: channel.units">\n        ').concat(L,"\n      </ul>\n      \x3c!-- /ko --\x3e\n\n    </div>\n  </div>\n  \x3c!-- /ko --\x3e\n\n"),H="\n\n  \x3c!-- ko if: isEditState --\x3e\n  ".concat(D,"\n  \x3c!-- /ko --\x3e\n\n  \x3c!-- ko ifnot: isEditState --\x3e\n  ").concat('\n  <div>\n    \x3c!-- ko with: activeChannel --\x3e\n    <button class="ui button bmpp-channelSlug"\n      data-bind="css: channel.color, text: channel.id,\n        popup: tooltip, popupOpts: channelPopupOpts">\n    </button>\n    \x3c!-- /ko --\x3e\n    <span style="padding-left: .5em">Тип единицы:</span>\n    \x3c!-- ko with: node.unitType --\x3e\n      <strong data-bind="text: hasAbbr ? abbr : name"\n        style="padding-left: .5em"></strong>\n    \x3c!-- /ko --\x3e\n    <div style="margin-top: 4em">\n      <span data-bind="click: goEditUnitType" class="bmpp-editUrl">\n        Изменить тип единицы\n      </span>\n    </div>\n  </div>\n',"\n  \x3c!-- /ko --\x3e\n\n"),$=function(){function e(t,n,a){f(this,e);var r=this;this.channel=t,this.isActive=i.computed(function(){var e=n();return e&&e.channel&&e.channel.id===r.channel.id}),this.isMouseOver=i.observable(!1),this.onMouseOver=function(){r.isMouseOver(!0)},this.onMouseOut=function(){r.isMouseOver(!1)},this.disabled=this.channel.disabled||0===r.channel.totalNumberOfUnits,this.onClick=function(){r.disabled||(1===r.channel.totalNumberOfUnits?(n(r),a.call(r.channel.getSingleUnit())):n(r))},this.buttonCSS=i.computed(function(){var e=r.isActive(),t=r.isMouseOver();return n()?e||t?r.channel.color:"".concat(r.channel.color," basic"):r.channel.color})}return y(e,[{key:"tooltip",get:function(){return this.disabled?this.channel.name+'\n\n  <div style="font-size: smaller; font-style: italic">\n    Аннотация пока не готова.\n  </div>\n\n':this.channel.name}},{key:"channelPopupOpts",get:function(){return{variation:"basic",delay:{show:700,hide:0},duration:400,transition:"fade",onVisible:function(e){setTimeout(function(e){n(e).popup("hide")}.bind(this,e),1700)}}}}]),e}(),M={viewModel:function(){function e(t){f(this,e);var n=t.node,a=n.unitType(),r=a&&a.channel,s=i.observable(null),o=i.observable(!a),l=t.queryPartsNonReadiness,c=function(){o(!0)},d=function(){n.unitType(this),o(!1),t.isQueryNew(!0)},u=[];l.push(o);var p=!0,h=!1,m=void 0;try{for(var b,v=T[Symbol.iterator]();!(p=(b=v.next()).done);p=!0){var y=b.value,g=new $(y,s,d);u.push(g),r&&r.id===y.id&&s(g)}}catch(e){h=!0,m=e}finally{try{p||null==v.return||v.return()}finally{if(h)throw m}}a||c(),this.node=n,this.channelViewModels=u,this.channelsHelp={html:A,opts:{variation:"basic",delay:{show:400,hide:0},duration:400}},this.activeChannel=s,this.isEditState=o,this.queryPartsNonReadiness=l,this.goEditUnitType=c,this.iHaveChosenUnitType=d}return y(e,[{key:"dispose",value:function(){this.queryPartsNonReadiness.remove(this.isEditState)}}]),e}(),template:H};var I=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];f(this,e),this.parentNode=t,this.childNodes=i.observableArray([]),this.relationsToParentNode=i.observableArray([]),this.depth=i.observable(t&&t.depth()+1||0),this.level=i.observable(0),this.serialNumber=i.observable(0),this.negative=i.observable(n),this.unitType=i.observable(null),null!==t&&this.addRelation()}return y(e,[{key:"addChild",value:function(){var t=new e(this,arguments.length>0&&void 0!==arguments[0]&&arguments[0]);this.childNodes.push(t)}},{key:"addRelation",value:function(){this.relationsToParentNode.push(new V(this.parentNode,this))}},{key:"removeRelation",value:function(e){this.relationsToParentNode.remove(e)}},{key:"seppuku",value:function(){var e=!0,t=!1,n=void 0;try{for(var i,a=this.childNodes()[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){i.value.seppuku()}}catch(e){t=!0,n=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw n}}this.relationsToParentNode.removeAll(),this.childNodes.removeAll(),this.parentNode.childNodes.remove(this)}}]),e}(),V=function e(t,n){f(this,e),this.parentNode=t,this.childNode=n};var Q=[{id:"pears04",label:"Pears 04",query:4},{id:"pears22",label:"Pears 22",query:22},{id:"pears23",label:"Pears 23",query:23},{id:"pears35",label:"Pears 35",query:35},{id:"pears37",label:"Pears 37",query:37,disabled:!0},{id:"pears39",label:"Pears 39",query:39,disabled:!0}],j=[{id:"narration",label:"Рассказ",query:"telling"},{id:"dialogue",label:"Разговор",query:"talk"},{id:"retelling",label:"Пересказ",query:"retelling"}],z=function e(t,n){f(this,e),this.value=i.observable(!1),this.id=t.id,this.label=t.label,this.disabled=Boolean(t.disabled),this.query=t.query,this.value.subscribe(function(){n(!0)})},B=function(){function e(t,n){f(this,e);var i=this;this.fields=[];var a=!0,r=!1,s=void 0;try{for(var o,l=t[Symbol.iterator]();!(a=(o=l.next()).done);a=!0){var c=o.value;this.fields.push(new z(c,n))}}catch(e){r=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(r)throw s}}this.invertSelection=function(){var e=!0,t=!1,n=void 0;try{for(var a,r=i.fields[Symbol.iterator]();!(e=(a=r.next()).done);e=!0){var s=a.value;s.disabled||s.value(!s.value())}}catch(e){t=!0,n=e}finally{try{e||null==r.return||r.return()}finally{if(t)throw n}}},this.clearSelection=function(){var e=!0,t=!1,n=void 0;try{for(var a,r=i.fields[Symbol.iterator]();!(e=(a=r.next()).done);e=!0){var s=a.value;s.disabled||s.value(!1)}}catch(e){t=!0,n=e}finally{try{e||null==r.return||r.return()}finally{if(t)throw n}}}}return y(e,[{key:"areAllUnchecked",value:function(){var e=!0,t=!1,n=void 0;try{for(var i,a=this.fields[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var r=i.value;if(!r.disabled&&r.value())return!1}}catch(e){t=!0,n=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw n}}return!0}},{key:"getAllButDisabledQueryValues",value:function(){var e=[],t=!0,n=!1,i=void 0;try{for(var a,r=this.fields[Symbol.iterator]();!(t=(a=r.next()).done);t=!0){var s=a.value;s.disabled||e.push(s.query)}}catch(e){n=!0,i=e}finally{try{t||null==r.return||r.return()}finally{if(n)throw i}}return e}},{key:"getAllCheckedQueryValues",value:function(){var e=[],t=!0,n=!1,i=void 0;try{for(var a,r=this.fields[Symbol.iterator]();!(t=(a=r.next()).done);t=!0){var s=a.value;!s.disabled&&s.value()&&e.push(s.query)}}catch(e){n=!0,i=e}finally{try{t||null==r.return||r.return()}finally{if(n)throw i}}return e}},{key:"getQueryValuesForJSON",value:function(){return this.areAllUnchecked()?this.getAllButDisabledQueryValues():this.getAllCheckedQueryValues()}}]),e}(),J=[{start:2.2,end:3.74,edu:"N-vE002",transcription:"Годов семидесятых я думаю.",comment:""},{start:6.01,end:8.49,edu:"N-vE005",transcription:"(ˀ 0.06) (ɐ 0.53) Мы видим˗м сельский /–пейзаж,,,",comment:""},{start:25.64,end:28.38,edu:"N-vE017",transcription:"у него (ɥ 0.29) на шее красный платок ↑завязан,",comment:""},{start:50.03,end:52.79,edu:"N-vE027",transcription:"там уже стоят (0.13) (ɥ 0.26) парочка корзин /полных,",comment:""},{start:65.95,end:68.35,edu:"N-vE034",transcription:"так всё очень не= || делает /нежно и любовноɯ.",comment:""},{start:106.37,end:107.35,edu:"N-vE064",transcription:"велосипед /большой,",comment:""},{start:107.35,end:108.55,edu:"N-vE065",transcription:"какие старые /советские,",comment:""},{start:131.45,end:133.38,edu:"N-vE079",transcription:"видит фермер собирает там –груши,",comment:""},{start:133.38,end:134.92,edu:"N-vE080",transcription:"полностью поглощён этим /занятием,",comment:""},{start:151.01,end:152.5,edu:"N-vE090",transcription:"с этой тяжеленной /↑корзиной,",comment:""},{start:192.57,end:193.79,edu:"N-vE117",transcription:"он один из них /приспускает,",comment:"Произносит [прыспускает]."},{start:228.21,end:230.18,edu:"N-vE136",transcription:"(ˀ 0.11) Они помогают ему /подняться=,",comment:""},{start:230.18,end:231.17,edu:"N-vE137",transcription:"(ə 0.04) (Двое /помогают,",comment:"Произносит [помогаюƟ]."},{start:231.17,end:233.48,edu:"N-vE138",transcription:"/ˀодин так и сту= || и стучит своей этой ↑штукой.)",comment:""},{start:255.66,end:256.96,edu:"N-vE152",transcription:"/поднимают они ↑её,",comment:""},{start:271.63,end:272.32,edu:"N-vE161",transcription:"взамен шляпы,",comment:""},{start:445.39,end:447.44,edu:"N-vE238",transcription:"/Корзины прям просто под грушей /стоят,",comment:""},{start:480.57,end:481.36,edu:"N-vE246",transcription:"Ничего не видно, ",comment:""},{start:596.29,end:597.69,edu:"N-vE289",transcription:"я бы свалилась точно.",comment:"Второе слово произносит [салилась]. Последнее слово — шепотом."},{start:766.41,end:768.09,edu:"N-vE325",transcription:"Как˗к какая-то əшпанаɯ.",comment:""},{start:770.11,end:772.28,edu:"N-vE326",transcription:"Ну /сначала как-то они подозрительно выглядят,",comment:""},{start:772.28,end:773.34,edu:"N-vE327",transcription:"но /вообще нормально.",comment:""},{start:773.34,end:774.34,edu:"N-vE328",transcription:"Они ему /помогают...",comment:""},{start:801.81,end:802.15,edu:"N-vE329",transcription:"(ɯ 0.19) Да,",comment:""},{start:802.15,end:803.46,edu:"N-vE330",transcription:"он /садится,",comment:""},{start:803.63,end:805.6,edu:"N-vE331",transcription:"(ə 0.16) см= || смотрит свою /–коленку,,, ≈≈",comment:""},{start:805.6,end:806.23,edu:"N-vE332",transcription:"Ну прямо так, ",comment:""},{start:806.23,end:807.02,edu:"N-vE333",transcription:"он /лежал сначала,",comment:""},{start:841.78,end:843.47,edu:"N-vE343",transcription:"ˀОни ст= || поднимают ему всё это,",comment:""},{start:928.41,end:928.89,edu:"N-vE364",transcription:"/Не- н˗не!,",comment:""},{start:1092.77,end:1095.3,edu:"N-vE385",transcription:"мы /ничего˗оə || (0.40) уже не поправляем /никого.",comment:""}],G=e("bmpp-videoPlayer");var X=new function(){var e=this,t=this;this.queryPane=Symbol.for("query"),this.subcorpusPane=Symbol.for("subcorpus"),this.resultsPane=Symbol.for("results"),this.resultsOptionsPane=Symbol.for("resoptions"),this.panes=[this.queryPane,this.subcorpusPane,this.resultsPane,this.resultsOptionsPane],this.activePane=i.observable(),this.switchOnQueryPane=function(){t.activePane(t.queryPane)},this.switchOnSubcorpusPane=function(){t.activePane(t.subcorpusPane)},this.switchOnResultsPane=function(){t.activePane(t.resultsPane)},this.switchOnResultsOptionsPane=function(){t.activePane(t.resultsOptionsPane)},this.isQueryPaneOn=i.computed(function(){return e.activePane()===t.queryPane}),this.isSubcorpusPaneOn=i.computed(function(){return e.activePane()===t.subcorpusPane}),this.isResultsPaneOn=i.computed(function(){return e.activePane()===t.resultsPane}),this.isResultsOptionsPaneOn=i.computed(function(){return e.activePane()===t.resultsOptionsPane}),i.computed(function(){var e=t.activePane();e&&(b("/".concat(Symbol.keyFor(e))),G.pause())}),this.queryPartsNonReadiness=i.observableArray([]),this.isQueryReady=i.computed(function(){var e=!0,n=!1,i=void 0;try{for(var a,r=t.queryPartsNonReadiness()[Symbol.iterator]();!(e=(a=r.next()).done);e=!0)if((0,a.value)())return!1}catch(e){n=!0,i=e}finally{try{e||null==r.return||r.return()}finally{if(n)throw i}}return!(!t.queryTree||!t.queryTree.unitType())}).extend({rateLimit:50}),this.isQueryNew=i.observable(!0),this.isSubcorpusNew=i.observable(!1),this.subcorpus={records:new B(Q,this.isSubcorpusNew),recordPhases:new B(j,this.isSubcorpusNew)},this.queryTree=new I,this.canSearch=i.computed(function(){var e=t.isQueryReady(),n=t.isQueryNew(),i=t.isSubcorpusNew();return!(!e||!n&&!i)}),this.lastQueryJSON="",this.queryJSON=i.computed(function(){return t.canSearch()&&(t.lastQueryJSON=function(e){for(var t={version:1,record_ids:e.subcorpus.records.getQueryValuesForJSON(),segments:e.subcorpus.recordPhases.getQueryValuesForJSON(),conditions:{}},n=w(e.queryTree),i=0;i<n.length;i++){var a=n[i],r={type:"simple",is_regex:!0,search:".+",duration:[]};if(r.tiers=[a.unitType().channel.id,a.unitType().id],t.conditions[a.serialNumber().toString()]=r,i>0){var s=a.parentNode,o=a,l=s.serialNumber().toString(),c=o.serialNumber().toString(),d={first_condition_id:l,second_condition_id:c,is_same_tier:s.unitType().channel.id===o.unitType().channel.id,type:"overlaps"};t.conditions["".concat(l,".").concat(c)]=d}}return JSON.stringify(t,null,4)}(t)),t.lastQueryJSON}).extend({rateLimit:500}),this.search=function(){t.canSearch()&&(t.isSearchInProgress(!0),setTimeout(function(){t.isSearchInProgress(!1),t.isQueryNew(!1),t.isSubcorpusNew(!1),t.canViewResults(!0),t.switchOnResultsPane()},1e3))},this.isSearchInProgress=i.observable(!1),this.canViewResults=i.observable(!1),this.results=J,this.playVideo=function(e){G.currentTime(e.start),G.play()}};!function(e,t){e.bindingHandlers.popup={init:function(t,i,a){var r=e.unwrap(i()),s=a.get("popupOpts")||{};s.html=r,n(t).popup(s),e.unwrap(a.get("popupAdditionalShowOnClick"))&&n(t).click(function(){n(t).popup("show")})}},e.components.register("bmpp-checkbox",S),e.components.register("query-pane",x),e.components.register("subcorpus-pane",C),e.components.register("query-node",P),e.components.register("query-node-relations",_),e.components.register("search-unit-choice",M),e.applyBindings(t)}(i,X);var Y=Symbol.keyFor(X.queryPane),Z=Symbol.keyFor(X.subcorpusPane),K=Symbol.keyFor(X.resultsPane),W=Symbol.keyFor(X.resultsOptionsPane);b.base("/bumppo-ghpages/05"),b("/",function(){X.activePane(X.queryPane)}),b("/".concat(Y),function(){X.activePane(X.queryPane)}),b("/".concat(Z),function(){X.activePane(X.subcorpusPane)}),b("/".concat(K),function(){X.activePane(X.resultsPane)}),b("/".concat(W),function(){X.activePane(X.resultsOptionsPane)}),b({hashbang:!0}),n(".bmpp-sidePane_menuItem").mouseover(function(){n(this).hasClass("disabled")||n(this).addClass("bmpp-sidePane_menuItem--hover")}),n(".bmpp-sidePane_menuItem").mouseout(function(){n(this).removeClass("bmpp-sidePane_menuItem--hover")}),G.ready(function(){var e=G.volume();G.volume(0),G.currentTime(0),G.pause(),G.volume(e)})}(videojs,SVG,jQuery,ko);
//# sourceMappingURL=spa.js.map
