{"version":3,"file":"spa.js","sources":["../../node_modules/style-inject/dist/style-inject.es.js","../../node_modules/debug/node_modules/ms/index.js","../../node_modules/debug/src/common.js","../../node_modules/debug/src/browser.js","../../src/scripts/log.js","../../node_modules/page/page.js","../../src/scripts/linearizeTree.js","../../src/scripts/searchUnits.js","../../src/ko.components/queryPane.js","../../src/ko.components/subcorpusPane.js","../../src/ko.components/propertiesPane.js","../../src/scripts/drawQueryTree.js","../../src/ko.components/queryNode.js","../../src/ko.components/queryNodeRelations.js","../../src/ko.components/checkbox.js","../../src/ko.components/searchUnitChoice.js","../../src/scripts/searchUnitProperties.js","../../src/scripts/queryTree.js","../../src/scripts/subcorpus.js","../../src/results_data.js","../../src/app.js","../../src/scripts/queryJSON.js","../../src/scripts/init.knockout.js"],"sourcesContent":["function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","/**\n * Helpers.\n */\n\nvar s = 1000;\nvar m = s * 60;\nvar h = m * 60;\nvar d = h * 24;\nvar w = d * 7;\nvar y = d * 365.25;\n\n/**\n * Parse or format the given `val`.\n *\n * Options:\n *\n *  - `long` verbose formatting [false]\n *\n * @param {String|Number} val\n * @param {Object} [options]\n * @throws {Error} throw an error if val is not a non-empty string or a number\n * @return {String|Number}\n * @api public\n */\n\nmodule.exports = function(val, options) {\n  options = options || {};\n  var type = typeof val;\n  if (type === 'string' && val.length > 0) {\n    return parse(val);\n  } else if (type === 'number' && isNaN(val) === false) {\n    return options.long ? fmtLong(val) : fmtShort(val);\n  }\n  throw new Error(\n    'val is not a non-empty string or a valid number. val=' +\n      JSON.stringify(val)\n  );\n};\n\n/**\n * Parse the given `str` and return milliseconds.\n *\n * @param {String} str\n * @return {Number}\n * @api private\n */\n\nfunction parse(str) {\n  str = String(str);\n  if (str.length > 100) {\n    return;\n  }\n  var match = /^((?:\\d+)?\\-?\\d?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(\n    str\n  );\n  if (!match) {\n    return;\n  }\n  var n = parseFloat(match[1]);\n  var type = (match[2] || 'ms').toLowerCase();\n  switch (type) {\n    case 'years':\n    case 'year':\n    case 'yrs':\n    case 'yr':\n    case 'y':\n      return n * y;\n    case 'weeks':\n    case 'week':\n    case 'w':\n      return n * w;\n    case 'days':\n    case 'day':\n    case 'd':\n      return n * d;\n    case 'hours':\n    case 'hour':\n    case 'hrs':\n    case 'hr':\n    case 'h':\n      return n * h;\n    case 'minutes':\n    case 'minute':\n    case 'mins':\n    case 'min':\n    case 'm':\n      return n * m;\n    case 'seconds':\n    case 'second':\n    case 'secs':\n    case 'sec':\n    case 's':\n      return n * s;\n    case 'milliseconds':\n    case 'millisecond':\n    case 'msecs':\n    case 'msec':\n    case 'ms':\n      return n;\n    default:\n      return undefined;\n  }\n}\n\n/**\n * Short format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtShort(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return Math.round(ms / d) + 'd';\n  }\n  if (msAbs >= h) {\n    return Math.round(ms / h) + 'h';\n  }\n  if (msAbs >= m) {\n    return Math.round(ms / m) + 'm';\n  }\n  if (msAbs >= s) {\n    return Math.round(ms / s) + 's';\n  }\n  return ms + 'ms';\n}\n\n/**\n * Long format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtLong(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return plural(ms, msAbs, d, 'day');\n  }\n  if (msAbs >= h) {\n    return plural(ms, msAbs, h, 'hour');\n  }\n  if (msAbs >= m) {\n    return plural(ms, msAbs, m, 'minute');\n  }\n  if (msAbs >= s) {\n    return plural(ms, msAbs, s, 'second');\n  }\n  return ms + ' ms';\n}\n\n/**\n * Pluralization helper.\n */\n\nfunction plural(ms, msAbs, n, name) {\n  var isPlural = msAbs >= n * 1.5;\n  return Math.round(ms / n) + ' ' + name + (isPlural ? 's' : '');\n}\n","\n/**\n * This is the common logic for both the Node.js and web browser\n * implementations of `debug()`.\n */\n\nfunction setup(env) {\n\tcreateDebug.debug = createDebug;\n\tcreateDebug.default = createDebug;\n\tcreateDebug.coerce = coerce;\n\tcreateDebug.disable = disable;\n\tcreateDebug.enable = enable;\n\tcreateDebug.enabled = enabled;\n\tcreateDebug.humanize = require('ms');\n\n\tObject.keys(env).forEach(key => {\n\t\tcreateDebug[key] = env[key];\n\t});\n\n\t/**\n\t* Active `debug` instances.\n\t*/\n\tcreateDebug.instances = [];\n\n\t/**\n\t* The currently active debug mode names, and names to skip.\n\t*/\n\n\tcreateDebug.names = [];\n\tcreateDebug.skips = [];\n\n\t/**\n\t* Map of special \"%n\" handling functions, for the debug \"format\" argument.\n\t*\n\t* Valid key names are a single, lower or upper-case letter, i.e. \"n\" and \"N\".\n\t*/\n\tcreateDebug.formatters = {};\n\n\t/**\n\t* Selects a color for a debug namespace\n\t* @param {String} namespace The namespace string for the for the debug instance to be colored\n\t* @return {Number|String} An ANSI color code for the given namespace\n\t* @api private\n\t*/\n\tfunction selectColor(namespace) {\n\t\tlet hash = 0;\n\n\t\tfor (let i = 0; i < namespace.length; i++) {\n\t\t\thash = ((hash << 5) - hash) + namespace.charCodeAt(i);\n\t\t\thash |= 0; // Convert to 32bit integer\n\t\t}\n\n\t\treturn createDebug.colors[Math.abs(hash) % createDebug.colors.length];\n\t}\n\tcreateDebug.selectColor = selectColor;\n\n\t/**\n\t* Create a debugger with the given `namespace`.\n\t*\n\t* @param {String} namespace\n\t* @return {Function}\n\t* @api public\n\t*/\n\tfunction createDebug(namespace) {\n\t\tlet prevTime;\n\n\t\tfunction debug(...args) {\n\t\t\t// Disabled?\n\t\t\tif (!debug.enabled) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst self = debug;\n\n\t\t\t// Set `diff` timestamp\n\t\t\tconst curr = Number(new Date());\n\t\t\tconst ms = curr - (prevTime || curr);\n\t\t\tself.diff = ms;\n\t\t\tself.prev = prevTime;\n\t\t\tself.curr = curr;\n\t\t\tprevTime = curr;\n\n\t\t\targs[0] = createDebug.coerce(args[0]);\n\n\t\t\tif (typeof args[0] !== 'string') {\n\t\t\t\t// Anything else let's inspect with %O\n\t\t\t\targs.unshift('%O');\n\t\t\t}\n\n\t\t\t// Apply any `formatters` transformations\n\t\t\tlet index = 0;\n\t\t\targs[0] = args[0].replace(/%([a-zA-Z%])/g, (match, format) => {\n\t\t\t\t// If we encounter an escaped % then don't increase the array index\n\t\t\t\tif (match === '%%') {\n\t\t\t\t\treturn match;\n\t\t\t\t}\n\t\t\t\tindex++;\n\t\t\t\tconst formatter = createDebug.formatters[format];\n\t\t\t\tif (typeof formatter === 'function') {\n\t\t\t\t\tconst val = args[index];\n\t\t\t\t\tmatch = formatter.call(self, val);\n\n\t\t\t\t\t// Now we need to remove `args[index]` since it's inlined in the `format`\n\t\t\t\t\targs.splice(index, 1);\n\t\t\t\t\tindex--;\n\t\t\t\t}\n\t\t\t\treturn match;\n\t\t\t});\n\n\t\t\t// Apply env-specific formatting (colors, etc.)\n\t\t\tcreateDebug.formatArgs.call(self, args);\n\n\t\t\tconst logFn = self.log || createDebug.log;\n\t\t\tlogFn.apply(self, args);\n\t\t}\n\n\t\tdebug.namespace = namespace;\n\t\tdebug.enabled = createDebug.enabled(namespace);\n\t\tdebug.useColors = createDebug.useColors();\n\t\tdebug.color = selectColor(namespace);\n\t\tdebug.destroy = destroy;\n\t\tdebug.extend = extend;\n\t\t// Debug.formatArgs = formatArgs;\n\t\t// debug.rawLog = rawLog;\n\n\t\t// env-specific initialization logic for debug instances\n\t\tif (typeof createDebug.init === 'function') {\n\t\t\tcreateDebug.init(debug);\n\t\t}\n\n\t\tcreateDebug.instances.push(debug);\n\n\t\treturn debug;\n\t}\n\n\tfunction destroy() {\n\t\tconst index = createDebug.instances.indexOf(this);\n\t\tif (index !== -1) {\n\t\t\tcreateDebug.instances.splice(index, 1);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tfunction extend(namespace, delimiter) {\n\t\treturn createDebug(this.namespace + (typeof delimiter === 'undefined' ? ':' : delimiter) + namespace);\n\t}\n\n\t/**\n\t* Enables a debug mode by namespaces. This can include modes\n\t* separated by a colon and wildcards.\n\t*\n\t* @param {String} namespaces\n\t* @api public\n\t*/\n\tfunction enable(namespaces) {\n\t\tcreateDebug.save(namespaces);\n\n\t\tcreateDebug.names = [];\n\t\tcreateDebug.skips = [];\n\n\t\tlet i;\n\t\tconst split = (typeof namespaces === 'string' ? namespaces : '').split(/[\\s,]+/);\n\t\tconst len = split.length;\n\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tif (!split[i]) {\n\t\t\t\t// ignore empty strings\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tnamespaces = split[i].replace(/\\*/g, '.*?');\n\n\t\t\tif (namespaces[0] === '-') {\n\t\t\t\tcreateDebug.skips.push(new RegExp('^' + namespaces.substr(1) + '$'));\n\t\t\t} else {\n\t\t\t\tcreateDebug.names.push(new RegExp('^' + namespaces + '$'));\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0; i < createDebug.instances.length; i++) {\n\t\t\tconst instance = createDebug.instances[i];\n\t\t\tinstance.enabled = createDebug.enabled(instance.namespace);\n\t\t}\n\t}\n\n\t/**\n\t* Disable debug output.\n\t*\n\t* @return {String} namespaces\n\t* @api public\n\t*/\n\tfunction disable() {\n\t\tconst namespaces = [\n\t\t\t...createDebug.names.map(toNamespace),\n\t\t\t...createDebug.skips.map(toNamespace).map(namespace => '-' + namespace)\n\t\t].join(',');\n\t\tcreateDebug.enable('');\n\t\treturn namespaces;\n\t}\n\n\t/**\n\t* Returns true if the given mode name is enabled, false otherwise.\n\t*\n\t* @param {String} name\n\t* @return {Boolean}\n\t* @api public\n\t*/\n\tfunction enabled(name) {\n\t\tif (name[name.length - 1] === '*') {\n\t\t\treturn true;\n\t\t}\n\n\t\tlet i;\n\t\tlet len;\n\n\t\tfor (i = 0, len = createDebug.skips.length; i < len; i++) {\n\t\t\tif (createDebug.skips[i].test(name)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0, len = createDebug.names.length; i < len; i++) {\n\t\t\tif (createDebug.names[i].test(name)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t/**\n\t* Convert regexp to namespace\n\t*\n\t* @param {RegExp} regxep\n\t* @return {String} namespace\n\t* @api private\n\t*/\n\tfunction toNamespace(regexp) {\n\t\treturn regexp.toString()\n\t\t\t.substring(2, regexp.toString().length - 2)\n\t\t\t.replace(/\\.\\*\\?$/, '*');\n\t}\n\n\t/**\n\t* Coerce `val`.\n\t*\n\t* @param {Mixed} val\n\t* @return {Mixed}\n\t* @api private\n\t*/\n\tfunction coerce(val) {\n\t\tif (val instanceof Error) {\n\t\t\treturn val.stack || val.message;\n\t\t}\n\t\treturn val;\n\t}\n\n\tcreateDebug.enable(createDebug.load());\n\n\treturn createDebug;\n}\n\nmodule.exports = setup;\n","/* eslint-env browser */\n\n/**\n * This is the web browser implementation of `debug()`.\n */\n\nexports.log = log;\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\nexports.storage = localstorage();\n\n/**\n * Colors.\n */\n\nexports.colors = [\n\t'#0000CC',\n\t'#0000FF',\n\t'#0033CC',\n\t'#0033FF',\n\t'#0066CC',\n\t'#0066FF',\n\t'#0099CC',\n\t'#0099FF',\n\t'#00CC00',\n\t'#00CC33',\n\t'#00CC66',\n\t'#00CC99',\n\t'#00CCCC',\n\t'#00CCFF',\n\t'#3300CC',\n\t'#3300FF',\n\t'#3333CC',\n\t'#3333FF',\n\t'#3366CC',\n\t'#3366FF',\n\t'#3399CC',\n\t'#3399FF',\n\t'#33CC00',\n\t'#33CC33',\n\t'#33CC66',\n\t'#33CC99',\n\t'#33CCCC',\n\t'#33CCFF',\n\t'#6600CC',\n\t'#6600FF',\n\t'#6633CC',\n\t'#6633FF',\n\t'#66CC00',\n\t'#66CC33',\n\t'#9900CC',\n\t'#9900FF',\n\t'#9933CC',\n\t'#9933FF',\n\t'#99CC00',\n\t'#99CC33',\n\t'#CC0000',\n\t'#CC0033',\n\t'#CC0066',\n\t'#CC0099',\n\t'#CC00CC',\n\t'#CC00FF',\n\t'#CC3300',\n\t'#CC3333',\n\t'#CC3366',\n\t'#CC3399',\n\t'#CC33CC',\n\t'#CC33FF',\n\t'#CC6600',\n\t'#CC6633',\n\t'#CC9900',\n\t'#CC9933',\n\t'#CCCC00',\n\t'#CCCC33',\n\t'#FF0000',\n\t'#FF0033',\n\t'#FF0066',\n\t'#FF0099',\n\t'#FF00CC',\n\t'#FF00FF',\n\t'#FF3300',\n\t'#FF3333',\n\t'#FF3366',\n\t'#FF3399',\n\t'#FF33CC',\n\t'#FF33FF',\n\t'#FF6600',\n\t'#FF6633',\n\t'#FF9900',\n\t'#FF9933',\n\t'#FFCC00',\n\t'#FFCC33'\n];\n\n/**\n * Currently only WebKit-based Web Inspectors, Firefox >= v31,\n * and the Firebug extension (any Firefox version) are known\n * to support \"%c\" CSS customizations.\n *\n * TODO: add a `localStorage` variable to explicitly enable/disable colors\n */\n\n// eslint-disable-next-line complexity\nfunction useColors() {\n\t// NB: In an Electron preload script, document will be defined but not fully\n\t// initialized. Since we know we're in Chrome, we'll just detect this case\n\t// explicitly\n\tif (typeof window !== 'undefined' && window.process && (window.process.type === 'renderer' || window.process.__nwjs)) {\n\t\treturn true;\n\t}\n\n\t// Internet Explorer and Edge do not support colors.\n\tif (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/(edge|trident)\\/(\\d+)/)) {\n\t\treturn false;\n\t}\n\n\t// Is webkit? http://stackoverflow.com/a/16459606/376773\n\t// document is undefined in react-native: https://github.com/facebook/react-native/pull/1632\n\treturn (typeof document !== 'undefined' && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance) ||\n\t\t// Is firebug? http://stackoverflow.com/a/398120/376773\n\t\t(typeof window !== 'undefined' && window.console && (window.console.firebug || (window.console.exception && window.console.table))) ||\n\t\t// Is firefox >= v31?\n\t\t// https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages\n\t\t(typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/) && parseInt(RegExp.$1, 10) >= 31) ||\n\t\t// Double check webkit in userAgent just in case we are in a worker\n\t\t(typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/applewebkit\\/(\\d+)/));\n}\n\n/**\n * Colorize log arguments if enabled.\n *\n * @api public\n */\n\nfunction formatArgs(args) {\n\targs[0] = (this.useColors ? '%c' : '') +\n\t\tthis.namespace +\n\t\t(this.useColors ? ' %c' : ' ') +\n\t\targs[0] +\n\t\t(this.useColors ? '%c ' : ' ') +\n\t\t'+' + module.exports.humanize(this.diff);\n\n\tif (!this.useColors) {\n\t\treturn;\n\t}\n\n\tconst c = 'color: ' + this.color;\n\targs.splice(1, 0, c, 'color: inherit');\n\n\t// The final \"%c\" is somewhat tricky, because there could be other\n\t// arguments passed either before or after the %c, so we need to\n\t// figure out the correct index to insert the CSS into\n\tlet index = 0;\n\tlet lastC = 0;\n\targs[0].replace(/%[a-zA-Z%]/g, match => {\n\t\tif (match === '%%') {\n\t\t\treturn;\n\t\t}\n\t\tindex++;\n\t\tif (match === '%c') {\n\t\t\t// We only are interested in the *last* %c\n\t\t\t// (the user may have provided their own)\n\t\t\tlastC = index;\n\t\t}\n\t});\n\n\targs.splice(lastC, 0, c);\n}\n\n/**\n * Invokes `console.log()` when available.\n * No-op when `console.log` is not a \"function\".\n *\n * @api public\n */\nfunction log(...args) {\n\t// This hackery is required for IE8/9, where\n\t// the `console.log` function doesn't have 'apply'\n\treturn typeof console === 'object' &&\n\t\tconsole.log &&\n\t\tconsole.log(...args);\n}\n\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\nfunction save(namespaces) {\n\ttry {\n\t\tif (namespaces) {\n\t\t\texports.storage.setItem('debug', namespaces);\n\t\t} else {\n\t\t\texports.storage.removeItem('debug');\n\t\t}\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n}\n\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\nfunction load() {\n\tlet r;\n\ttry {\n\t\tr = exports.storage.getItem('debug');\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n\n\t// If debug isn't set in LS, and we're in Electron, try to load $DEBUG\n\tif (!r && typeof process !== 'undefined' && 'env' in process) {\n\t\tr = process.env.DEBUG;\n\t}\n\n\treturn r;\n}\n\n/**\n * Localstorage attempts to return the localstorage.\n *\n * This is necessary because safari throws\n * when a user disables cookies/localstorage\n * and you attempt to access it.\n *\n * @return {LocalStorage}\n * @api private\n */\n\nfunction localstorage() {\n\ttry {\n\t\t// TVMLKit (Apple TV JS Runtime) does not have a window object, just localStorage in the global context\n\t\t// The Browser also has localStorage in the global context.\n\t\treturn localStorage;\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n}\n\nmodule.exports = require('./common')(exports);\n\nconst {formatters} = module.exports;\n\n/**\n * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.\n */\n\nformatters.j = function (v) {\n\ttry {\n\t\treturn JSON.stringify(v);\n\t} catch (error) {\n\t\treturn '[UnexpectedJSONParseError]: ' + error.message;\n\t}\n};\n","import debug from 'debug';\nconst log = debug('bumppo:log');\n\n// eslint-disable-next-line no-undef\nif (BUMPPO_ENV !== 'production') {\n  debug.enable('bumppo:*');\n  log('Logging is enabled!');\n} else {\n  debug.disable();\n}\n\nexport default log;\n","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.page = factory());\n}(this, (function () { 'use strict';\n\nvar isarray = Array.isArray || function (arr) {\n  return Object.prototype.toString.call(arr) == '[object Array]';\n};\n\n/**\n * Expose `pathToRegexp`.\n */\nvar pathToRegexp_1 = pathToRegexp;\nvar parse_1 = parse;\nvar compile_1 = compile;\nvar tokensToFunction_1 = tokensToFunction;\nvar tokensToRegExp_1 = tokensToRegExp;\n\n/**\n * The main path matching regexp utility.\n *\n * @type {RegExp}\n */\nvar PATH_REGEXP = new RegExp([\n  // Match escaped characters that would otherwise appear in future matches.\n  // This allows the user to escape special characters that won't transform.\n  '(\\\\\\\\.)',\n  // Match Express-style parameters and un-named parameters with a prefix\n  // and optional suffixes. Matches appear as:\n  //\n  // \"/:test(\\\\d+)?\" => [\"/\", \"test\", \"\\d+\", undefined, \"?\", undefined]\n  // \"/route(\\\\d+)\"  => [undefined, undefined, undefined, \"\\d+\", undefined, undefined]\n  // \"/*\"            => [\"/\", undefined, undefined, undefined, undefined, \"*\"]\n  '([\\\\/.])?(?:(?:\\\\:(\\\\w+)(?:\\\\(((?:\\\\\\\\.|[^()])+)\\\\))?|\\\\(((?:\\\\\\\\.|[^()])+)\\\\))([+*?])?|(\\\\*))'\n].join('|'), 'g');\n\n/**\n * Parse a string for the raw tokens.\n *\n * @param  {String} str\n * @return {Array}\n */\nfunction parse (str) {\n  var tokens = [];\n  var key = 0;\n  var index = 0;\n  var path = '';\n  var res;\n\n  while ((res = PATH_REGEXP.exec(str)) != null) {\n    var m = res[0];\n    var escaped = res[1];\n    var offset = res.index;\n    path += str.slice(index, offset);\n    index = offset + m.length;\n\n    // Ignore already escaped sequences.\n    if (escaped) {\n      path += escaped[1];\n      continue\n    }\n\n    // Push the current path onto the tokens.\n    if (path) {\n      tokens.push(path);\n      path = '';\n    }\n\n    var prefix = res[2];\n    var name = res[3];\n    var capture = res[4];\n    var group = res[5];\n    var suffix = res[6];\n    var asterisk = res[7];\n\n    var repeat = suffix === '+' || suffix === '*';\n    var optional = suffix === '?' || suffix === '*';\n    var delimiter = prefix || '/';\n    var pattern = capture || group || (asterisk ? '.*' : '[^' + delimiter + ']+?');\n\n    tokens.push({\n      name: name || key++,\n      prefix: prefix || '',\n      delimiter: delimiter,\n      optional: optional,\n      repeat: repeat,\n      pattern: escapeGroup(pattern)\n    });\n  }\n\n  // Match any characters still remaining.\n  if (index < str.length) {\n    path += str.substr(index);\n  }\n\n  // If the path exists, push it onto the end.\n  if (path) {\n    tokens.push(path);\n  }\n\n  return tokens\n}\n\n/**\n * Compile a string to a template function for the path.\n *\n * @param  {String}   str\n * @return {Function}\n */\nfunction compile (str) {\n  return tokensToFunction(parse(str))\n}\n\n/**\n * Expose a method for transforming tokens into the path function.\n */\nfunction tokensToFunction (tokens) {\n  // Compile all the tokens into regexps.\n  var matches = new Array(tokens.length);\n\n  // Compile all the patterns before compilation.\n  for (var i = 0; i < tokens.length; i++) {\n    if (typeof tokens[i] === 'object') {\n      matches[i] = new RegExp('^' + tokens[i].pattern + '$');\n    }\n  }\n\n  return function (obj) {\n    var path = '';\n    var data = obj || {};\n\n    for (var i = 0; i < tokens.length; i++) {\n      var token = tokens[i];\n\n      if (typeof token === 'string') {\n        path += token;\n\n        continue\n      }\n\n      var value = data[token.name];\n      var segment;\n\n      if (value == null) {\n        if (token.optional) {\n          continue\n        } else {\n          throw new TypeError('Expected \"' + token.name + '\" to be defined')\n        }\n      }\n\n      if (isarray(value)) {\n        if (!token.repeat) {\n          throw new TypeError('Expected \"' + token.name + '\" to not repeat, but received \"' + value + '\"')\n        }\n\n        if (value.length === 0) {\n          if (token.optional) {\n            continue\n          } else {\n            throw new TypeError('Expected \"' + token.name + '\" to not be empty')\n          }\n        }\n\n        for (var j = 0; j < value.length; j++) {\n          segment = encodeURIComponent(value[j]);\n\n          if (!matches[i].test(segment)) {\n            throw new TypeError('Expected all \"' + token.name + '\" to match \"' + token.pattern + '\", but received \"' + segment + '\"')\n          }\n\n          path += (j === 0 ? token.prefix : token.delimiter) + segment;\n        }\n\n        continue\n      }\n\n      segment = encodeURIComponent(value);\n\n      if (!matches[i].test(segment)) {\n        throw new TypeError('Expected \"' + token.name + '\" to match \"' + token.pattern + '\", but received \"' + segment + '\"')\n      }\n\n      path += token.prefix + segment;\n    }\n\n    return path\n  }\n}\n\n/**\n * Escape a regular expression string.\n *\n * @param  {String} str\n * @return {String}\n */\nfunction escapeString (str) {\n  return str.replace(/([.+*?=^!:${}()[\\]|\\/])/g, '\\\\$1')\n}\n\n/**\n * Escape the capturing group by escaping special characters and meaning.\n *\n * @param  {String} group\n * @return {String}\n */\nfunction escapeGroup (group) {\n  return group.replace(/([=!:$\\/()])/g, '\\\\$1')\n}\n\n/**\n * Attach the keys as a property of the regexp.\n *\n * @param  {RegExp} re\n * @param  {Array}  keys\n * @return {RegExp}\n */\nfunction attachKeys (re, keys) {\n  re.keys = keys;\n  return re\n}\n\n/**\n * Get the flags for a regexp from the options.\n *\n * @param  {Object} options\n * @return {String}\n */\nfunction flags (options) {\n  return options.sensitive ? '' : 'i'\n}\n\n/**\n * Pull out keys from a regexp.\n *\n * @param  {RegExp} path\n * @param  {Array}  keys\n * @return {RegExp}\n */\nfunction regexpToRegexp (path, keys) {\n  // Use a negative lookahead to match only capturing groups.\n  var groups = path.source.match(/\\((?!\\?)/g);\n\n  if (groups) {\n    for (var i = 0; i < groups.length; i++) {\n      keys.push({\n        name: i,\n        prefix: null,\n        delimiter: null,\n        optional: false,\n        repeat: false,\n        pattern: null\n      });\n    }\n  }\n\n  return attachKeys(path, keys)\n}\n\n/**\n * Transform an array into a regexp.\n *\n * @param  {Array}  path\n * @param  {Array}  keys\n * @param  {Object} options\n * @return {RegExp}\n */\nfunction arrayToRegexp (path, keys, options) {\n  var parts = [];\n\n  for (var i = 0; i < path.length; i++) {\n    parts.push(pathToRegexp(path[i], keys, options).source);\n  }\n\n  var regexp = new RegExp('(?:' + parts.join('|') + ')', flags(options));\n\n  return attachKeys(regexp, keys)\n}\n\n/**\n * Create a path regexp from string input.\n *\n * @param  {String} path\n * @param  {Array}  keys\n * @param  {Object} options\n * @return {RegExp}\n */\nfunction stringToRegexp (path, keys, options) {\n  var tokens = parse(path);\n  var re = tokensToRegExp(tokens, options);\n\n  // Attach keys back to the regexp.\n  for (var i = 0; i < tokens.length; i++) {\n    if (typeof tokens[i] !== 'string') {\n      keys.push(tokens[i]);\n    }\n  }\n\n  return attachKeys(re, keys)\n}\n\n/**\n * Expose a function for taking tokens and returning a RegExp.\n *\n * @param  {Array}  tokens\n * @param  {Array}  keys\n * @param  {Object} options\n * @return {RegExp}\n */\nfunction tokensToRegExp (tokens, options) {\n  options = options || {};\n\n  var strict = options.strict;\n  var end = options.end !== false;\n  var route = '';\n  var lastToken = tokens[tokens.length - 1];\n  var endsWithSlash = typeof lastToken === 'string' && /\\/$/.test(lastToken);\n\n  // Iterate over the tokens and create our regexp string.\n  for (var i = 0; i < tokens.length; i++) {\n    var token = tokens[i];\n\n    if (typeof token === 'string') {\n      route += escapeString(token);\n    } else {\n      var prefix = escapeString(token.prefix);\n      var capture = token.pattern;\n\n      if (token.repeat) {\n        capture += '(?:' + prefix + capture + ')*';\n      }\n\n      if (token.optional) {\n        if (prefix) {\n          capture = '(?:' + prefix + '(' + capture + '))?';\n        } else {\n          capture = '(' + capture + ')?';\n        }\n      } else {\n        capture = prefix + '(' + capture + ')';\n      }\n\n      route += capture;\n    }\n  }\n\n  // In non-strict mode we allow a slash at the end of match. If the path to\n  // match already ends with a slash, we remove it for consistency. The slash\n  // is valid at the end of a path match, not in the middle. This is important\n  // in non-ending mode, where \"/test/\" shouldn't match \"/test//route\".\n  if (!strict) {\n    route = (endsWithSlash ? route.slice(0, -2) : route) + '(?:\\\\/(?=$))?';\n  }\n\n  if (end) {\n    route += '$';\n  } else {\n    // In non-ending mode, we need the capturing groups to match as much as\n    // possible by using a positive lookahead to the end or next path segment.\n    route += strict && endsWithSlash ? '' : '(?=\\\\/|$)';\n  }\n\n  return new RegExp('^' + route, flags(options))\n}\n\n/**\n * Normalize the given path string, returning a regular expression.\n *\n * An empty array can be passed in for the keys, which will hold the\n * placeholder key descriptions. For example, using `/user/:id`, `keys` will\n * contain `[{ name: 'id', delimiter: '/', optional: false, repeat: false }]`.\n *\n * @param  {(String|RegExp|Array)} path\n * @param  {Array}                 [keys]\n * @param  {Object}                [options]\n * @return {RegExp}\n */\nfunction pathToRegexp (path, keys, options) {\n  keys = keys || [];\n\n  if (!isarray(keys)) {\n    options = keys;\n    keys = [];\n  } else if (!options) {\n    options = {};\n  }\n\n  if (path instanceof RegExp) {\n    return regexpToRegexp(path, keys, options)\n  }\n\n  if (isarray(path)) {\n    return arrayToRegexp(path, keys, options)\n  }\n\n  return stringToRegexp(path, keys, options)\n}\n\npathToRegexp_1.parse = parse_1;\npathToRegexp_1.compile = compile_1;\npathToRegexp_1.tokensToFunction = tokensToFunction_1;\npathToRegexp_1.tokensToRegExp = tokensToRegExp_1;\n\n/**\n   * Module dependencies.\n   */\n\n  \n\n  /**\n   * Short-cuts for global-object checks\n   */\n\n  var hasDocument = ('undefined' !== typeof document);\n  var hasWindow = ('undefined' !== typeof window);\n  var hasHistory = ('undefined' !== typeof history);\n  var hasProcess = typeof process !== 'undefined';\n\n  /**\n   * Detect click event\n   */\n  var clickEvent = hasDocument && document.ontouchstart ? 'touchstart' : 'click';\n\n  /**\n   * To work properly with the URL\n   * history.location generated polyfill in https://github.com/devote/HTML5-History-API\n   */\n\n  var isLocation = hasWindow && !!(window.history.location || window.location);\n\n  /**\n   * The page instance\n   * @api private\n   */\n  function Page() {\n    // public things\n    this.callbacks = [];\n    this.exits = [];\n    this.current = '';\n    this.len = 0;\n\n    // private things\n    this._decodeURLComponents = true;\n    this._base = '';\n    this._strict = false;\n    this._running = false;\n    this._hashbang = false;\n\n    // bound functions\n    this.clickHandler = this.clickHandler.bind(this);\n    this._onpopstate = this._onpopstate.bind(this);\n  }\n\n  /**\n   * Configure the instance of page. This can be called multiple times.\n   *\n   * @param {Object} options\n   * @api public\n   */\n\n  Page.prototype.configure = function(options) {\n    var opts = options || {};\n\n    this._window = opts.window || (hasWindow && window);\n    this._decodeURLComponents = opts.decodeURLComponents !== false;\n    this._popstate = opts.popstate !== false && hasWindow;\n    this._click = opts.click !== false && hasDocument;\n    this._hashbang = !!opts.hashbang;\n\n    var _window = this._window;\n    if(this._popstate) {\n      _window.addEventListener('popstate', this._onpopstate, false);\n    } else if(hasWindow) {\n      _window.removeEventListener('popstate', this._onpopstate, false);\n    }\n\n    if (this._click) {\n      _window.document.addEventListener(clickEvent, this.clickHandler, false);\n    } else if(hasDocument) {\n      _window.document.removeEventListener(clickEvent, this.clickHandler, false);\n    }\n\n    if(this._hashbang && hasWindow && !hasHistory) {\n      _window.addEventListener('hashchange', this._onpopstate, false);\n    } else if(hasWindow) {\n      _window.removeEventListener('hashchange', this._onpopstate, false);\n    }\n  };\n\n  /**\n   * Get or set basepath to `path`.\n   *\n   * @param {string} path\n   * @api public\n   */\n\n  Page.prototype.base = function(path) {\n    if (0 === arguments.length) return this._base;\n    this._base = path;\n  };\n\n  /**\n   * Gets the `base`, which depends on whether we are using History or\n   * hashbang routing.\n\n   * @api private\n   */\n  Page.prototype._getBase = function() {\n    var base = this._base;\n    if(!!base) return base;\n    var loc = hasWindow && this._window && this._window.location;\n\n    if(hasWindow && this._hashbang && loc && loc.protocol === 'file:') {\n      base = loc.pathname;\n    }\n\n    return base;\n  };\n\n  /**\n   * Get or set strict path matching to `enable`\n   *\n   * @param {boolean} enable\n   * @api public\n   */\n\n  Page.prototype.strict = function(enable) {\n    if (0 === arguments.length) return this._strict;\n    this._strict = enable;\n  };\n\n\n  /**\n   * Bind with the given `options`.\n   *\n   * Options:\n   *\n   *    - `click` bind to click events [true]\n   *    - `popstate` bind to popstate [true]\n   *    - `dispatch` perform initial dispatch [true]\n   *\n   * @param {Object} options\n   * @api public\n   */\n\n  Page.prototype.start = function(options) {\n    var opts = options || {};\n    this.configure(opts);\n\n    if (false === opts.dispatch) return;\n    this._running = true;\n\n    var url;\n    if(isLocation) {\n      var window = this._window;\n      var loc = window.location;\n\n      if(this._hashbang && ~loc.hash.indexOf('#!')) {\n        url = loc.hash.substr(2) + loc.search;\n      } else if (this._hashbang) {\n        url = loc.search + loc.hash;\n      } else {\n        url = loc.pathname + loc.search + loc.hash;\n      }\n    }\n\n    this.replace(url, null, true, opts.dispatch);\n  };\n\n  /**\n   * Unbind click and popstate event handlers.\n   *\n   * @api public\n   */\n\n  Page.prototype.stop = function() {\n    if (!this._running) return;\n    this.current = '';\n    this.len = 0;\n    this._running = false;\n\n    var window = this._window;\n    this._click && window.document.removeEventListener(clickEvent, this.clickHandler, false);\n    hasWindow && window.removeEventListener('popstate', this._onpopstate, false);\n    hasWindow && window.removeEventListener('hashchange', this._onpopstate, false);\n  };\n\n  /**\n   * Show `path` with optional `state` object.\n   *\n   * @param {string} path\n   * @param {Object=} state\n   * @param {boolean=} dispatch\n   * @param {boolean=} push\n   * @return {!Context}\n   * @api public\n   */\n\n  Page.prototype.show = function(path, state, dispatch, push) {\n    var ctx = new Context(path, state, this),\n      prev = this.prevContext;\n    this.prevContext = ctx;\n    this.current = ctx.path;\n    if (false !== dispatch) this.dispatch(ctx, prev);\n    if (false !== ctx.handled && false !== push) ctx.pushState();\n    return ctx;\n  };\n\n  /**\n   * Goes back in the history\n   * Back should always let the current route push state and then go back.\n   *\n   * @param {string} path - fallback path to go back if no more history exists, if undefined defaults to page.base\n   * @param {Object=} state\n   * @api public\n   */\n\n  Page.prototype.back = function(path, state) {\n    var page = this;\n    if (this.len > 0) {\n      var window = this._window;\n      // this may need more testing to see if all browsers\n      // wait for the next tick to go back in history\n      hasHistory && window.history.back();\n      this.len--;\n    } else if (path) {\n      setTimeout(function() {\n        page.show(path, state);\n      });\n    } else {\n      setTimeout(function() {\n        page.show(page._getBase(), state);\n      });\n    }\n  };\n\n  /**\n   * Register route to redirect from one path to other\n   * or just redirect to another route\n   *\n   * @param {string} from - if param 'to' is undefined redirects to 'from'\n   * @param {string=} to\n   * @api public\n   */\n  Page.prototype.redirect = function(from, to) {\n    var inst = this;\n\n    // Define route from a path to another\n    if ('string' === typeof from && 'string' === typeof to) {\n      page.call(this, from, function(e) {\n        setTimeout(function() {\n          inst.replace(/** @type {!string} */ (to));\n        }, 0);\n      });\n    }\n\n    // Wait for the push state and replace it with another\n    if ('string' === typeof from && 'undefined' === typeof to) {\n      setTimeout(function() {\n        inst.replace(from);\n      }, 0);\n    }\n  };\n\n  /**\n   * Replace `path` with optional `state` object.\n   *\n   * @param {string} path\n   * @param {Object=} state\n   * @param {boolean=} init\n   * @param {boolean=} dispatch\n   * @return {!Context}\n   * @api public\n   */\n\n\n  Page.prototype.replace = function(path, state, init, dispatch) {\n    var ctx = new Context(path, state, this),\n      prev = this.prevContext;\n    this.prevContext = ctx;\n    this.current = ctx.path;\n    ctx.init = init;\n    ctx.save(); // save before dispatching, which may redirect\n    if (false !== dispatch) this.dispatch(ctx, prev);\n    return ctx;\n  };\n\n  /**\n   * Dispatch the given `ctx`.\n   *\n   * @param {Context} ctx\n   * @api private\n   */\n\n  Page.prototype.dispatch = function(ctx, prev) {\n    var i = 0, j = 0, page = this;\n\n    function nextExit() {\n      var fn = page.exits[j++];\n      if (!fn) return nextEnter();\n      fn(prev, nextExit);\n    }\n\n    function nextEnter() {\n      var fn = page.callbacks[i++];\n\n      if (ctx.path !== page.current) {\n        ctx.handled = false;\n        return;\n      }\n      if (!fn) return unhandled.call(page, ctx);\n      fn(ctx, nextEnter);\n    }\n\n    if (prev) {\n      nextExit();\n    } else {\n      nextEnter();\n    }\n  };\n\n  /**\n   * Register an exit route on `path` with\n   * callback `fn()`, which will be called\n   * on the previous context when a new\n   * page is visited.\n   */\n  Page.prototype.exit = function(path, fn) {\n    if (typeof path === 'function') {\n      return this.exit('*', path);\n    }\n\n    var route = new Route(path, null, this);\n    for (var i = 1; i < arguments.length; ++i) {\n      this.exits.push(route.middleware(arguments[i]));\n    }\n  };\n\n  /**\n   * Handle \"click\" events.\n   */\n\n  /* jshint +W054 */\n  Page.prototype.clickHandler = function(e) {\n    if (1 !== this._which(e)) return;\n\n    if (e.metaKey || e.ctrlKey || e.shiftKey) return;\n    if (e.defaultPrevented) return;\n\n    // ensure link\n    // use shadow dom when available if not, fall back to composedPath()\n    // for browsers that only have shady\n    var el = e.target;\n    var eventPath = e.path || (e.composedPath ? e.composedPath() : null);\n\n    if(eventPath) {\n      for (var i = 0; i < eventPath.length; i++) {\n        if (!eventPath[i].nodeName) continue;\n        if (eventPath[i].nodeName.toUpperCase() !== 'A') continue;\n        if (!eventPath[i].href) continue;\n\n        el = eventPath[i];\n        break;\n      }\n    }\n\n    // continue ensure link\n    // el.nodeName for svg links are 'a' instead of 'A'\n    while (el && 'A' !== el.nodeName.toUpperCase()) el = el.parentNode;\n    if (!el || 'A' !== el.nodeName.toUpperCase()) return;\n\n    // check if link is inside an svg\n    // in this case, both href and target are always inside an object\n    var svg = (typeof el.href === 'object') && el.href.constructor.name === 'SVGAnimatedString';\n\n    // Ignore if tag has\n    // 1. \"download\" attribute\n    // 2. rel=\"external\" attribute\n    if (el.hasAttribute('download') || el.getAttribute('rel') === 'external') return;\n\n    // ensure non-hash for the same path\n    var link = el.getAttribute('href');\n    if(!this._hashbang && this._samePath(el) && (el.hash || '#' === link)) return;\n\n    // Check for mailto: in the href\n    if (link && link.indexOf('mailto:') > -1) return;\n\n    // check target\n    // svg target is an object and its desired value is in .baseVal property\n    if (svg ? el.target.baseVal : el.target) return;\n\n    // x-origin\n    // note: svg links that are not relative don't call click events (and skip page.js)\n    // consequently, all svg links tested inside page.js are relative and in the same origin\n    if (!svg && !this.sameOrigin(el.href)) return;\n\n    // rebuild path\n    // There aren't .pathname and .search properties in svg links, so we use href\n    // Also, svg href is an object and its desired value is in .baseVal property\n    var path = svg ? el.href.baseVal : (el.pathname + el.search + (el.hash || ''));\n\n    path = path[0] !== '/' ? '/' + path : path;\n\n    // strip leading \"/[drive letter]:\" on NW.js on Windows\n    if (hasProcess && path.match(/^\\/[a-zA-Z]:\\//)) {\n      path = path.replace(/^\\/[a-zA-Z]:\\//, '/');\n    }\n\n    // same page\n    var orig = path;\n    var pageBase = this._getBase();\n\n    if (path.indexOf(pageBase) === 0) {\n      path = path.substr(pageBase.length);\n    }\n\n    if (this._hashbang) path = path.replace('#!', '');\n\n    if (pageBase && orig === path && (!isLocation || this._window.location.protocol !== 'file:')) {\n      return;\n    }\n\n    e.preventDefault();\n    this.show(orig);\n  };\n\n  /**\n   * Handle \"populate\" events.\n   * @api private\n   */\n\n  Page.prototype._onpopstate = (function () {\n    var loaded = false;\n    if ( ! hasWindow ) {\n      return function () {};\n    }\n    if (hasDocument && document.readyState === 'complete') {\n      loaded = true;\n    } else {\n      window.addEventListener('load', function() {\n        setTimeout(function() {\n          loaded = true;\n        }, 0);\n      });\n    }\n    return function onpopstate(e) {\n      if (!loaded) return;\n      var page = this;\n      if (e.state) {\n        var path = e.state.path;\n        page.replace(path, e.state);\n      } else if (isLocation) {\n        var loc = page._window.location;\n        page.show(loc.pathname + loc.search + loc.hash, undefined, undefined, false);\n      }\n    };\n  })();\n\n  /**\n   * Event button.\n   */\n  Page.prototype._which = function(e) {\n    e = e || (hasWindow && this._window.event);\n    return null == e.which ? e.button : e.which;\n  };\n\n  /**\n   * Convert to a URL object\n   * @api private\n   */\n  Page.prototype._toURL = function(href) {\n    var window = this._window;\n    if(typeof URL === 'function' && isLocation) {\n      return new URL(href, window.location.toString());\n    } else if (hasDocument) {\n      var anc = window.document.createElement('a');\n      anc.href = href;\n      return anc;\n    }\n  };\n\n  /**\n   * Check if `href` is the same origin.\n   * @param {string} href\n   * @api public\n   */\n\n  Page.prototype.sameOrigin = function(href) {\n    if(!href || !isLocation) return false;\n\n    var url = this._toURL(href);\n    var window = this._window;\n\n    var loc = window.location;\n    return loc.protocol === url.protocol &&\n      loc.hostname === url.hostname &&\n      loc.port === url.port;\n  };\n\n  /**\n   * @api private\n   */\n  Page.prototype._samePath = function(url) {\n    if(!isLocation) return false;\n    var window = this._window;\n    var loc = window.location;\n    return url.pathname === loc.pathname &&\n      url.search === loc.search;\n  };\n\n  /**\n   * Remove URL encoding from the given `str`.\n   * Accommodates whitespace in both x-www-form-urlencoded\n   * and regular percent-encoded form.\n   *\n   * @param {string} val - URL component to decode\n   * @api private\n   */\n  Page.prototype._decodeURLEncodedURIComponent = function(val) {\n    if (typeof val !== 'string') { return val; }\n    return this._decodeURLComponents ? decodeURIComponent(val.replace(/\\+/g, ' ')) : val;\n  };\n\n  /**\n   * Create a new `page` instance and function\n   */\n  function createPage() {\n    var pageInstance = new Page();\n\n    function pageFn(/* args */) {\n      return page.apply(pageInstance, arguments);\n    }\n\n    // Copy all of the things over. In 2.0 maybe we use setPrototypeOf\n    pageFn.callbacks = pageInstance.callbacks;\n    pageFn.exits = pageInstance.exits;\n    pageFn.base = pageInstance.base.bind(pageInstance);\n    pageFn.strict = pageInstance.strict.bind(pageInstance);\n    pageFn.start = pageInstance.start.bind(pageInstance);\n    pageFn.stop = pageInstance.stop.bind(pageInstance);\n    pageFn.show = pageInstance.show.bind(pageInstance);\n    pageFn.back = pageInstance.back.bind(pageInstance);\n    pageFn.redirect = pageInstance.redirect.bind(pageInstance);\n    pageFn.replace = pageInstance.replace.bind(pageInstance);\n    pageFn.dispatch = pageInstance.dispatch.bind(pageInstance);\n    pageFn.exit = pageInstance.exit.bind(pageInstance);\n    pageFn.configure = pageInstance.configure.bind(pageInstance);\n    pageFn.sameOrigin = pageInstance.sameOrigin.bind(pageInstance);\n    pageFn.clickHandler = pageInstance.clickHandler.bind(pageInstance);\n\n    pageFn.create = createPage;\n\n    Object.defineProperty(pageFn, 'len', {\n      get: function(){\n        return pageInstance.len;\n      },\n      set: function(val) {\n        pageInstance.len = val;\n      }\n    });\n\n    Object.defineProperty(pageFn, 'current', {\n      get: function(){\n        return pageInstance.current;\n      },\n      set: function(val) {\n        pageInstance.current = val;\n      }\n    });\n\n    // In 2.0 these can be named exports\n    pageFn.Context = Context;\n    pageFn.Route = Route;\n\n    return pageFn;\n  }\n\n  /**\n   * Register `path` with callback `fn()`,\n   * or route `path`, or redirection,\n   * or `page.start()`.\n   *\n   *   page(fn);\n   *   page('*', fn);\n   *   page('/user/:id', load, user);\n   *   page('/user/' + user.id, { some: 'thing' });\n   *   page('/user/' + user.id);\n   *   page('/from', '/to')\n   *   page();\n   *\n   * @param {string|!Function|!Object} path\n   * @param {Function=} fn\n   * @api public\n   */\n\n  function page(path, fn) {\n    // <callback>\n    if ('function' === typeof path) {\n      return page.call(this, '*', path);\n    }\n\n    // route <path> to <callback ...>\n    if ('function' === typeof fn) {\n      var route = new Route(/** @type {string} */ (path), null, this);\n      for (var i = 1; i < arguments.length; ++i) {\n        this.callbacks.push(route.middleware(arguments[i]));\n      }\n      // show <path> with [state]\n    } else if ('string' === typeof path) {\n      this['string' === typeof fn ? 'redirect' : 'show'](path, fn);\n      // start [options]\n    } else {\n      this.start(path);\n    }\n  }\n\n  /**\n   * Unhandled `ctx`. When it's not the initial\n   * popstate then redirect. If you wish to handle\n   * 404s on your own use `page('*', callback)`.\n   *\n   * @param {Context} ctx\n   * @api private\n   */\n  function unhandled(ctx) {\n    if (ctx.handled) return;\n    var current;\n    var page = this;\n    var window = page._window;\n\n    if (page._hashbang) {\n      current = isLocation && this._getBase() + window.location.hash.replace('#!', '');\n    } else {\n      current = isLocation && window.location.pathname + window.location.search;\n    }\n\n    if (current === ctx.canonicalPath) return;\n    page.stop();\n    ctx.handled = false;\n    isLocation && (window.location.href = ctx.canonicalPath);\n  }\n\n  /**\n   * Initialize a new \"request\" `Context`\n   * with the given `path` and optional initial `state`.\n   *\n   * @constructor\n   * @param {string} path\n   * @param {Object=} state\n   * @api public\n   */\n\n  function Context(path, state, pageInstance) {\n    var _page = this.page = pageInstance || page;\n    var window = _page._window;\n    var hashbang = _page._hashbang;\n\n    var pageBase = _page._getBase();\n    if ('/' === path[0] && 0 !== path.indexOf(pageBase)) path = pageBase + (hashbang ? '#!' : '') + path;\n    var i = path.indexOf('?');\n\n    this.canonicalPath = path;\n    this.path = path.replace(pageBase, '') || '/';\n    if (hashbang) this.path = this.path.replace('#!', '') || '/';\n\n    this.title = (hasDocument && window.document.title);\n    this.state = state || {};\n    this.state.path = path;\n    this.querystring = ~i ? _page._decodeURLEncodedURIComponent(path.slice(i + 1)) : '';\n    this.pathname = _page._decodeURLEncodedURIComponent(~i ? path.slice(0, i) : path);\n    this.params = {};\n\n    // fragment\n    this.hash = '';\n    if (!hashbang) {\n      if (!~this.path.indexOf('#')) return;\n      var parts = this.path.split('#');\n      this.path = this.pathname = parts[0];\n      this.hash = _page._decodeURLEncodedURIComponent(parts[1]) || '';\n      this.querystring = this.querystring.split('#')[0];\n    }\n  }\n\n  /**\n   * Push state.\n   *\n   * @api private\n   */\n\n  Context.prototype.pushState = function() {\n    var page = this.page;\n    var window = page._window;\n    var hashbang = page._hashbang;\n\n    page.len++;\n    if (hasHistory) {\n        window.history.pushState(this.state, this.title,\n          hashbang && this.path !== '/' ? '#!' + this.path : this.canonicalPath);\n    }\n  };\n\n  /**\n   * Save the context state.\n   *\n   * @api public\n   */\n\n  Context.prototype.save = function() {\n    var page = this.page;\n    if (hasHistory && page._window.location.protocol !== 'file:') {\n        page._window.history.replaceState(this.state, this.title,\n          page._hashbang && this.path !== '/' ? '#!' + this.path : this.canonicalPath);\n    }\n  };\n\n  /**\n   * Initialize `Route` with the given HTTP `path`,\n   * and an array of `callbacks` and `options`.\n   *\n   * Options:\n   *\n   *   - `sensitive`    enable case-sensitive routes\n   *   - `strict`       enable strict matching for trailing slashes\n   *\n   * @constructor\n   * @param {string} path\n   * @param {Object=} options\n   * @api private\n   */\n\n  function Route(path, options, page) {\n    var _page = this.page = page || globalPage;\n    var opts = options || {};\n    opts.strict = opts.strict || page._strict;\n    this.path = (path === '*') ? '(.*)' : path;\n    this.method = 'GET';\n    this.regexp = pathToRegexp_1(this.path, this.keys = [], opts);\n  }\n\n  /**\n   * Return route middleware with\n   * the given callback `fn()`.\n   *\n   * @param {Function} fn\n   * @return {Function}\n   * @api public\n   */\n\n  Route.prototype.middleware = function(fn) {\n    var self = this;\n    return function(ctx, next) {\n      if (self.match(ctx.path, ctx.params)) return fn(ctx, next);\n      next();\n    };\n  };\n\n  /**\n   * Check if this route matches `path`, if so\n   * populate `params`.\n   *\n   * @param {string} path\n   * @param {Object} params\n   * @return {boolean}\n   * @api private\n   */\n\n  Route.prototype.match = function(path, params) {\n    var keys = this.keys,\n      qsIndex = path.indexOf('?'),\n      pathname = ~qsIndex ? path.slice(0, qsIndex) : path,\n      m = this.regexp.exec(decodeURIComponent(pathname));\n\n    if (!m) return false;\n\n    for (var i = 1, len = m.length; i < len; ++i) {\n      var key = keys[i - 1];\n      var val = this.page._decodeURLEncodedURIComponent(m[i]);\n      if (val !== undefined || !(hasOwnProperty.call(params, key.name))) {\n        params[key.name] = val;\n      }\n    }\n\n    return true;\n  };\n\n\n  /**\n   * Module exports.\n   */\n\n  var globalPage = createPage();\n  var page_js = globalPage;\n  var default_1 = globalPage;\n\npage_js.default = default_1;\n\nreturn page_js;\n\n})));\n","export default function linearizeTree(node, treeLinearForm=[], isFirstChild=true) {\n  var depth = node.depth(),\n      levels = linearizeTree.levels;\n  if (depth == 0) {\n    levels = linearizeTree.levels = [0];\n    linearizeTree.serialNumber = 1;\n  } else if (depth !== 0 && !(levels instanceof Array)) {\n    throw 'Нарушена правильная работа функции линеаризации дерева';\n  } else if (isFirstChild) {\n    levels.push(0);\n  } else if (levels.length === depth + 1) {\n    levels[levels.length - 1] += 1;\n  } else {\n    let mx = Math.max(...levels.slice(depth));\n    levels.splice(depth);\n    levels[depth] = mx + 1;\n  }\n  node.level(levels.slice(-1)[0]);\n  node.serialNumber(linearizeTree.serialNumber);\n  linearizeTree.serialNumber += 1;\n  treeLinearForm.push(node);\n  if (node.childNodes().length > 0) {\n    for (let i = 0; i < node.childNodes().length; i++) {\n      let childNode = node.childNodes()[i],\n          isFirstChild = i == 0;\n      treeLinearForm = linearizeTree(childNode, treeLinearForm, isFirstChild);\n    }\n  }\n  return treeLinearForm;\n}\n","var data = [\n  { id: 'voc',\n    name: 'Вокальные действия',\n    unitsHeader: 'Вокальные единицы',\n    color: 'red',\n    types: [\n      { name: 'Верхний уровень сегментации',\n        types: [\n          { name: 'Элементарная дискурсивная единица (ЭДЕ)', abbr: 'ЭДЕ', id: 'u_vEDU' },\n          { name: 'Изолированный смех', id: 'u_vLaughLine'},\n          { name: 'Изолированный кластер заполненных пауз', id: 'u_vFilledLine' },\n          { name: 'Самостоятельное неречевое вокальное явление', id: 'u_vNonVerbalLine' },\n        ]},\n      { name: 'Нижний уровень сегментации',\n        types: [\n          { name: 'Слово', id: 'u_vWord' },\n          { name: 'Cмех', id: 'u_vLaughSegm'},\n          { name: 'Заполненная пауза', id: 'u_vFilledSegm' },\n          { name: 'Пауза со вдохом', id: 'u_vHPause' },\n          { name: 'Неречевое вокальное действие', id: 'u_vOtherSegm' },\n          { name: 'Абсолютная пауза', id: 'u_v--AbsolutePause' },\n        ]},\n      { name: 'Параллельный уровень сегментации',\n        types: [\n          { name: 'Вокальное явление, накладывающееся на речь', id: 'u_vCollat' },\n        ]},\n    ]},\n\n  { id: 'ocul',\n    name: 'Направление взора',\n    unitsHeader: 'Единицы окуломоторного канала',\n    color: 'orange',\n    types: [\n      { name: 'Фиксация', id: 'u_oFixation' },\n    ]},\n\n  { id: 'facial',\n    name: 'Мимика',\n    unitsHeader: 'Единицы канала мимики',\n    color: 'yellow',\n    disabled: true,\n    types: []},\n\n  { id: 'ceph',\n    name: 'Жесты головы',\n    unitsHeader: 'Единицы цефалической жестикуляции',\n    color: 'green',\n    types: [\n      { name: 'Базовый уровень сегментации',\n        types: [\n          { name: 'Движение', id: 'u_c1' },\n          { name: 'Неподвижность', id: 'u_c2' },\n        ]},\n      { name: 'Дополнительный уровень сегментации',\n        types: [\n          { name: 'Жест', id: 'u_c3' },\n          { name: 'Адаптор', id: 'u_c4' },\n          { name: 'Смена позы', id: 'u_c5' },\n        ]},\n    ]},\n\n  { id: 'manu',\n    name: 'Жесты рук',\n    unitsHeader: 'Единицы мануальной жестикуляции',\n    color: 'teal',\n    types: [\n      { name: 'Первый уровень сегментации',\n        types: [\n          { name: 'Движение', id: 'u_m1' },\n          { name: 'Неподвижность', id: 'u_m2' },\n        ]},\n      { name: 'Второй уровень сегментации',\n        types: [\n          { name: 'Жест', id: 'u_m3' },\n          { name: 'Адаптор', id: 'u_m4' },\n          { name: 'Смена позы', id: 'u_m5' },\n        ]},\n      { name: 'Третий уровень сегментации',\n        types: [\n          { name: 'Мануальная поза', id: 'u_m6' },\n          { name: 'Фаза перехода', id: 'u_m7' },\n          { name: 'Двигательная цепочка', id: 'u_m8' },\n          { name: 'Жестовая цепочка', id: 'u_m9' },\n        ]},\n    ]},\n\n  { id: 'torso',\n    name: 'Движения тела',\n    unitsHeader: 'Единицы жестикуляции тела',\n    color: 'blue',\n    disabled: true,\n    types: []},\n\n  { id: 'prox',\n    name: 'Проксемика',\n    unitsHeader: 'Единицы проксемики',\n    color: 'violet',\n    disabled: true,\n    types: []},\n];\n\nclass Unit {\n  constructor(data, channel, group=null) {\n    this.id = data.id;\n    this.name = data.name;\n    this.channel = channel;\n    this.group = group;\n    this.hasAbbr = Boolean(data.abbr);\n    this.abbr = data.abbr || '';\n  }\n}\n\nclass UnitGroup {\n  constructor(data, channel) {\n    this.name = data.name;\n    this.channel = channel;\n    this.units = [];\n    this.totalNumberOfUnits = 0;\n\n    this.populateUnits(data);\n  }\n  populateUnits(data) {\n    for (let x of data.types) {\n      this.units.push(new Unit(x, this.channel, this));\n      this.totalNumberOfUnits += 1;\n    }\n  }\n}\n\nclass Channel {\n  constructor(data) {\n    this.id = data.id;\n    this.name = data.name || '';\n    this.unitsHeader = data.unitsHeader || '';\n    this.color = data.color;\n    this.disabled = data.disabled;\n\n    this.groups = [];\n    this.units = [];\n    this.totalNumberOfUnits = 0;\n\n    this.populateGroupsAndUnits(data);\n  }\n  populateGroupsAndUnits(data) {\n    for (let x of data.types) {\n      if (x.types) {\n        let unitGroup = new UnitGroup(x, this);\n        this.groups.push(unitGroup);\n        this.totalNumberOfUnits += unitGroup.totalNumberOfUnits;\n      } else {\n        this.units.push(new Unit(x, this));\n        this.totalNumberOfUnits += 1;\n      }\n    }\n  }\n  getSingleUnit() {\n    if (this.totalNumberOfUnits === 1) {\n      let x = this.units.slice()\n        .concat(...this.groups.map(g => g.units.slice()));\n      if (x.length > 0) return x[0];\n    }\n    return null;\n  }\n}\n\nlet channels = [];\n\nfor (let x of data) {\n  channels.push(new Channel(x));\n}\n\nexport { channels };\n","import ko from 'knockout';\nimport SVG from 'svg.js';\nimport linearizeTree from '../scripts/linearizeTree.js';\n\nconst svgDrawElementId = 'svgQueryTree',\n      template = `\n\n  <div class=\"bmpp-queryPane\">\n    <div class=\"bmpp-queryTree\" id=\"${ svgDrawElementId }\">\n    </div>\n    <div class=\"bmpp-query\" data-bind=\"foreach: linearizedQueryTree\">\n\n      <query-node-relations params=\"node: $data, draw: $component.svgDraw\"\n        data-bind=\"visible: $data.parentNode\">\n      </query-node-relations>\n\n      <query-node params=\"node: $data, draw: $component.svgDraw\"></query-node>\n\n    </div>\n  </div>\n\n`;\n\n// eslint-disable-next-line no-unused-vars\nvar viewModelFactory = (params, componentInfo) => {\n\n  var redrawTree = (linearizedTree) => {\n    for (let treeNode of linearizedTree) {\n      if (treeNode.svgSlug) {\n        treeNode.svgSlug.position();\n      }\n    }\n    for (let treeNode of linearizedTree.slice(1)) {\n      if (treeNode.svgRelationLine) {\n        treeNode.svgRelationLine.redrawLine();\n      }\n    }\n  };\n\n  var linearizedQueryTree = ko.computed(() => {\n    let tree = linearizeTree(params.queryTree, []);\n    for (let node of tree) {\n      node.childNodes();\n    }\n    return tree;\n  });\n  linearizedQueryTree.subscribe(redrawTree);\n\n  var domObserver = new MutationObserver(function() {\n    if (redrawTree.timeoutID !== undefined) {\n      clearTimeout(redrawTree.timeoutID);\n    }\n    redrawTree.timeoutID = setTimeout(() => {\n      redrawTree(linearizedQueryTree());\n    }, 30);\n    return true;\n  });\n  domObserver.observe(componentInfo.element, { childList: true, subtree: true,\n    attributes: false, characterData: false, attributeOldValue: false,\n    characterDataOldValue: false });\n\n  let viewModel = {\n    linearizedQueryTree: linearizedQueryTree,\n    svgDraw: SVG(svgDrawElementId).size('100%', '100%')\n  };\n\n  return viewModel;\n};\n\n// KnockoutJS component\nexport default {\n  viewModel: { createViewModel: viewModelFactory },\n  template: template\n};\n","import jQuery from 'jquery';\n\nconst recordsHelp = `\n\n  <p>При выборе одного или нескольких вариантов поиск будет\n  вестись только по указанным записям. В&nbsp;настоящий момент\n  для поиска доступны 4 из 6 записей.</p>\n\n`;\n\nconst recordsPhasesHelp = `\n\n  <p>При выборе одного или нескольких вариантов поиск будет\n  вестись только по указанным этапам: рассказу, разговору или\n  пересказу.</p>\n\n`;\n\nconst template = `\n\n  <h1 class=\"ui header\">Область поиска</h1>\n  <div class=\"ui grid\">\n    <div class=\"ten wide column\" data-bind=\"with: records\">\n      <div class=\"ui padded segment bmpp-subcorpusForm\">\n        <div class=\"ui top attached large label\">\n          <header data-bind=\"click: invertSelection\">\n            Записи\n          </header>\n          <i class=\"disabled question circle outline icon\n                    bmpp-nearLabelIcon bmpp-recordsHelp\"></i>\n        </div>\n\n        <div class=\"ui form\" data-bind=\"foreach: fields\">\n          <div class=\"field\">\n            <bmpp-checkbox params=\"value: value, label: label,\n              disabled: disabled, tabindex: $index,\n              disabledTooltip: 'Запись пока не готова'\"></bmpp-checkbox>\n          </div>\n        </div>\n\n      </div>\n    </div>\n\n    <div class=\"six wide column\" data-bind=\"with: recordPhases\">\n      <div class=\"ui padded segment bmpp-subcorpusForm\">\n        <div class=\"ui top attached large label\">\n          <header data-bind=\"click: invertSelection\">\n            Этапы записей\n          </header>\n          <i class=\"disabled question circle outline icon\n             bmpp-nearLabelIcon bmpp-recordsPhasesHelp\"></i>\n        </div>\n        <form class=\"ui form\" data-bind=\"foreach: fields\">\n          <div class=\"field\">\n            <bmpp-checkbox params=\"value: value, label: label,\n              tabindex: $index() + $root.subcorpus.records.fields.length\">\n            </bmpp-checkbox>\n          </div>\n        </form>\n\n      </div>\n    </div>\n\n    <div>\n      <button class=\"ui small button three wide column\"\n        data-bind=\"click: subcorpusClearSelection\">Очистить</button>\n      <button class=\"ui small button three wide column\">Отмена</button>\n    </div>\n\n  </div>\n\n`;\n\nvar viewModelFactory = (params, componentInfo) => {\n  let records = params.records,\n      recordPhases = params.recordPhases,\n      subcorpusClearSelection = () => {\n        if (!records.areAllUnchecked()) {\n          records.clearSelection();\n        }\n        if (!recordPhases.areAllUnchecked()) {\n          recordPhases.clearSelection();\n        }\n      },\n      popupOpts = {\n        variation: 'basic',\n        delay: { show: 400, hide: 0 },\n        duration: 400,\n      };\n\n  for (let { html, selector } of [\n    { html: recordsHelp, selector: '.bmpp-recordsHelp' },\n    { html: recordsPhasesHelp, selector: '.bmpp-recordsPhasesHelp' }\n  ]) {\n    popupOpts.html = html;\n    jQuery(componentInfo.element).find(selector).popup(popupOpts);\n  }\n\n  return {\n    records: records,\n    recordPhases: recordPhases,\n    subcorpusClearSelection: subcorpusClearSelection\n  };\n};\n\nexport default {\n  viewModel: { createViewModel: viewModelFactory },\n  template: template\n};\n","const template = `\n\n  <div class=\"bmpp-paddedPane\">\n    <header class=\"ui header\">Свойства поисковой единицы</header>\n    <div>\n      <button class=\"ui small button\"\n        data-bind=\"click: $root.queryPaneView.finishEditingNodeProperties\"\n        >ОК</button>\n      <button class=\"ui small button\">Очистить</button>\n      <button class=\"ui small button\"\n        data-bind=\"click: $root.queryPaneView.finishEditingNodeProperties\"\n        >Отмена</button>\n    </div>\n  </div>\n\n`;\n\n// eslint-disable-next-line no-unused-vars\nvar viewModelFactory = (params, componentInfo) => {\n  return {};\n};\n\nexport default {\n  viewModel: { createViewModel: viewModelFactory },\n  template: template\n};\n","import jQuery from 'jquery';\nimport ko from 'knockout';\n\nconst circRadius = 15,\n      circTopOffset = 18,\n      circLeftOffset = 83,\n      color = '#aaa';\n\nexport class Slug {\n  constructor(draw, element, treeNode) {\n    let svgCircle = this.drawCircle(draw);\n    let svgText = this.drawText(draw, treeNode.serialNumber());\n\n    this.draw = draw;\n    this.element = element;\n    this.treeNode = treeNode;\n    this.svgText = svgText;\n    this.svg = draw.group().add(svgCircle).add(svgText);\n\n    this.fineTune();\n  }\n  drawCircle(draw) {\n    let circle = draw.circle(circRadius * 2)\n      .attr({ fill: 'none', stroke: color, 'stroke-width': 1 })\n      .cx(circRadius).cy(circRadius);\n    return circle;\n  }\n  drawText(draw, text) {\n    let t = draw.text(String(text)).attr({ fill: color })\n      .cx(circRadius).cy(circRadius);\n    return t;\n  }\n  fineTune() {\n    this.position();\n    this.treeNode.serialNumber.subscribe((value) => {\n      this.changeText(value);\n    });\n    ko.utils.domNodeDisposal.addDisposeCallback(this.element, () => {\n      this.dispose();\n    });\n    this.treeNode.svgSlug = this;\n  }\n  position() {\n    let x = circLeftOffset,\n        y1 = jQuery(this.element).offset().top,\n        y2 = jQuery(this.element).parent().offset().top,\n        y = Math.abs(y1 - y2) + circTopOffset;\n    this.svg.x(x).y(y);\n  }\n  changeText(text) {\n    this.svgText = this.svgText.text(String(text));\n  }\n  dispose(){\n    this.svg.remove();\n    this.svgText.remove();\n  }\n}\n\nexport class RelationLine {\n  constructor(draw, element, treeNode) {\n    this.draw = draw;\n    this.element = element;\n    this.treeNode = treeNode;\n    this.svg = this.drawLine(draw, treeNode);\n\n    this.fineTune();\n  }\n\n  fineTune() {\n    ko.utils.domNodeDisposal.addDisposeCallback(this.element, () => {\n      this.dispose();\n    });\n    this.treeNode.svgRelationLine = this;\n  }\n\n  static calculatePath(slug1, slug2, level, relationsElementHeight) {\n    let s1 = slug1.svg,\n        s2 = slug2.svg,\n        r = circRadius,\n        b1 = r * 0.5,\n        b2 = relationsElementHeight - r * 3,\n        s = r * 1,\n        m1 = r * 1.3,\n        m2 = r * 0.5,\n        l1 = (level < 3) ? level : 2,\n        l2 = (level < 3) ? 0 : level - 2,\n        c = r * 3,\n        d = r * 4.5,\n        path;\n\n    if (level === 0) {\n      path = `M ${s1.cx()} ${s1.cy()+r}\n              L ${s2.cx()} ${s2.cy()-r}`;\n    } else {\n      path = `M ${s1.cx()} ${s1.cy()+r}\n              V ${s1.cy()+r+b1}\n              C ${s1.cx()} ${s1.cy()+r+b1+c}\n                ${s1.cx()-s-m1*l1-m2*l2} ${s1.cy()+r+b1+d-c}\n                ${s1.cx()-s-m1*l1-m2*l2} ${s1.cy()+r+b1+d}\n              V ${s2.cy()-r-b2-d}\n              C ${s2.cx()-s-m1*l1-m2*l2} ${s2.cy()-r-b2-d+c}\n                ${s2.cx()} ${s2.cy()-r-b2-c}\n                ${s2.cx()} ${s2.cy()-r-b2}\n              V ${s2.cy()-r}`;\n    }\n    return path;\n  }\n  drawLine(draw, treeNode) {\n    let path = '';\n    if (treeNode.parentNode) {\n      let parentSlug = treeNode.parentNode.svgSlug.svg;\n      path = `M ${parentSlug.cx()} ${parentSlug.cy()+circRadius}\n              L ${parentSlug.cx()} ${parentSlug.cy()+circRadius}`;\n    }\n    return draw.path(path).fill('none').stroke({ color: '#aaa', width: 1 });\n  }\n  redrawLine() {\n    let slug1 = this.treeNode.parentNode && this.treeNode.parentNode.svgSlug,\n        slug2 = this.treeNode.svgSlug,\n        level = this.treeNode.level,\n        rh = jQuery(this.element).height();\n    if (slug1 && slug2 && level) {\n      let path = RelationLine.calculatePath(slug1, slug2, level(), rh);\n      this.svg.plot(path);\n    }\n  }\n\n  dispose(){\n    this.svg.remove();\n  }\n}\n","import jQuery from 'jquery';\nimport { Slug } from '../scripts/drawQueryTree.js';\n\nconst template = `\n\n  <div class=\"bmpp-queryElement ui segment\"\n    data-bind=\"css: { 'bmpp-negativeNode': node.negative }\">\n\n    <div class=\"bmpp-queryTreeHandles\">\n\n      <i class=\"ui disabled green down arrow icon bmpp-addPositiveUnit\"\n        data-bind=\"click: node.addChild.bind(node, false),\n          visible: !node.negative() && node.unitType() !== null\"></i>\n\n      <i class=\"ui disabled red down arrow icon bmpp-addNegativeUnit\"\n        data-bind=\"click: node.addChild.bind(node, true),\n          visible: !node.negative() && node.unitType() !== null\"></i>\n\n      <i class=\"ui disabled grey close icon\"\n        title=\"Удалить единицу поиска со всеми зависимостями\"\n        data-bind=\"visible: node.depth() > 0,\n          click: function () {\n                   node.seppuku();\n                   $root.isQueryNew(true);\n                 }\"></i>\n    </div>\n\n    <div class=\"ui top attached basic red label\"\n      data-bind=\"visible: node.negative\">\n      НЕТ\n      <i class=\"disabled grey question circle outline icon\n        bmpp-nearLabelIcon bmpp-negativeUnitHelp\"></i>\n      <div class=\"ui basic popup hidden\">\n        <header class=\"ui header\">Отрицательное условие</header>\n\n        <p>При отрицательном условии ищутся контексты, в которых\n        <strong>нет</strong> единиц, обладающих указанными свойствами,\n        и располагающихся на указанном расстоянии.</p>\n\n        <p>Отрицательное условие всегда является терминальным: к ветке запроса,\n        заканчивающейся этой единицей, нельзя добавить еще одну единицу.</p>\n      </div>\n    </div>\n\n    <search-unit-choice params=\"node: node,\n      queryPartsNonReadiness: $root.queryPartsNonReadiness,\n      editNodeProperties: $root.queryPaneView.editNodeProperties,\n      finishEditingNodeProperties: $root.queryPaneView.finishEditingNodeProperties,\n      isQueryNew: $root.isQueryNew\">\n    </search-unit-choice>\n\n  </div>\n\n`;\n\nvar viewModelFactory = (params, componentInfo) => {\n  let node = params.node,\n      addUnitPopupOpts = {\n        variation: 'basic',\n        position: 'bottom right',\n        transition: 'fade',\n        delay: {\n          show: 1000,\n          hide: 0\n        },\n        duration: 400,\n        onVisible: function lazyHide(popupTarget) {\n          let hide = function (popupTarget) {\n            jQuery(popupTarget).popup('hide');\n          };\n          setTimeout(hide.bind(this, popupTarget), 1700);\n        }\n      };\n\n  new Slug(params.draw, componentInfo.element, node);\n\n  jQuery(document).ready(() => {\n    let x = jQuery(componentInfo.element);\n    addUnitPopupOpts.content = 'Добавить единицу поиска';\n    x.find('.bmpp-addPositiveUnit').popup(addUnitPopupOpts);\n    addUnitPopupOpts.content = 'Добавить отрицательную единицу поиска';\n    x.find('.bmpp-addNegativeUnit').popup(addUnitPopupOpts);\n    x.find('.bmpp-negativeUnitHelp').popup({ inline: true });\n  });\n  return { node: node };\n};\n\nexport default {\n  viewModel: { createViewModel: viewModelFactory },\n  template: template\n};\n","import jQuery from 'jquery';\nimport { RelationLine } from '../scripts/drawQueryTree.js';\n\nconst relationTemplate = `\n\n  <div class=\"bmpp-queryDistance ui secondary segment\">\n\n    <div class=\"ui tiny header\" data-bind=\"visible: $index() === 0\">\n      на расстоянии:\n    </div>\n\n    <div class=\"ui form\" style=\"margin-bottom: -1em;\">\n      <div class=\"bmpp-queryTreeHandles bmpp-queryTreeHandles2\">\n        <i class=\"ui small disabled grey plus icon\"\n          data-bind=\"visible: $index() === $component.relations().length - 1,\n                     click: childNode.addRelation.bind(childNode)\">\n        </i>\n\n        <i class=\"ui small icon\"\n          data-bind=\"visible: $index() !== $component.relations().length - 1\">\n        </i>\n\n        <i class=\"ui small disabled grey close icon\"\n          data-bind=\"visible: $index() !== 0,\n                   click: childNode.removeRelation.bind(childNode, $data)\"></i>\n      </div>\n\n      <div class=\"inline field bmpp-number\">\n        <label>от</label>\n        <input type=\"number\" step=\"50\" min=\"0\" placeholder=\"0\">\n      </div>\n\n      <div class=\"inline field bmpp-number\">\n        <label>до</label>\n        <input type=\"number\" step=\"50\" min=\"0\" placeholder=\"0\">\n      </div>\n\n      <div class=\"inline field bmpp-units\">\n        <div class=\"ui inline dropdown\">\n          <div class=\"default text\">миллисекунд</div>\n          <div class=\"menu\">\n            <div class=\"item\" data-value=\"ms\">миллисекунд</div>\n            <div class=\"item\" data-value=\"u\">единиц</div>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"inline field bmpp-points\">\n        <div class=\"ui selection dropdown\">\n          <input type=\"hidden\" name=\"pp\">\n          <label>между</label>\n          <i class=\"dropdown icon\"></i>\n          <div class=\"default text\">\n            началом\n            <div class=\"ui circular label\"\n              data-bind=\"text: childNode.serialNumber\"></div>\n          </div>\n          <div class=\"menu\">\n            <div class=\"item\" data-value=\"s\">\n              началом\n              <div class=\"ui circular label\"\n                data-bind=\"text: childNode.serialNumber\"></div>\n            </div>\n            <div class=\"item\" data-value=\"e\">\n              концом\n              <div class=\"ui circular label\"\n                data-bind=\"text: childNode.serialNumber\"></div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"inline field bmpp-points\">\n        <div class=\"ui selection dropdown\">\n          <input type=\"hidden\" name=\"cp\">\n          <label>и</label>\n          <i class=\"dropdown icon\"></i>\n          <div class=\"default text\">\n            началом\n            <div class=\"ui circular label\"\n              data-bind=\"text: parentNode.serialNumber\"></div>\n          </div>\n          <div class=\"menu\">\n            <div class=\"item\" data-value=\"s\">\n              началом\n              <div class=\"ui circular label\"\n                data-bind=\"text: parentNode.serialNumber\"></div>\n            </div>\n            <div class=\"item\" data-value=\"e\">\n              концом\n              <div class=\"ui circular label\"\n                data-bind=\"text: parentNode.serialNumber\"></div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n  </div>\n\n`;\n\nconst queryDistanceHelp = `\n\n  <header class=\"ui header\">Условие на расстояние</header>\n\n  <p>В качестве условий можно по отдельности указывать интервалы расстояний\n  между началами (левыми границами) и концами (правыми границами) единиц.\n  Например, если задать условие «от&nbsp;−50 до&nbsp;100&nbsp;мс между началом\n  X и началом Y», будут найдены контексты, в которых левая граница\n  X располагается не левее, чем в&nbsp;50&nbsp;мс, и не правее, чем\n  в&nbsp;100&nbsp;мс, от левой границы Y.</p>\n\n  <p>Если для условия указано только одно значение, ограничения с другой\n  стороны не накладывается. Если не указано ни одно значение, это\n  интерпретируется как интервал «от&nbsp;0 до&nbsp;0». Значения задаются\n  в миллисекундах. Если X и Y являются единицам одного типа, между началом\n  X и концом Y можно задать расстояние в терминах единицы данного типа.</p>\n\n`;\n\nconst template = `\n\n  <div class=\"bmpp-queryDistances ui segments\"\n    data-bind=\"css: { 'bmpp-queryDistances--toOtherElement':\n                      $component.node.level() > 0 }\">\n\n    <!-- ko foreach: relations -->\n      ${relationTemplate}\n    <!-- /ko -->\n\n    <i class=\"ui disabled grey question circle outline icon\n              bmpp-queryDistanceHelp\"></i>\n  </div>\n\n`;\n\nvar viewModelFactory = (params, componentInfo) => {\n  let node = params.node,\n      element = componentInfo.element,\n      popupOpts = {\n        html: queryDistanceHelp,\n        variation: 'basic fluid',\n        setFluidWidth: false,\n        delay: { show: 400, hide: 0 },\n        duration: 400,\n        lastResort: true,\n        onShow: function (targetElement) {\n          let popup = jQuery(targetElement).popup('get popup');\n          jQuery(popup).attr('style', 'width: 35em!important');\n        }\n      };\n\n  new RelationLine(params.draw, element, node);\n\n  jQuery(element).find('.bmpp-queryDistanceHelp').popup(popupOpts);\n  jQuery.initialize('.ui.dropdown', function () {\n    jQuery(this).dropdown();\n  }, { target: element });\n\n  return { relations: node.relationsToParentNode, node: node };\n};\n\nexport default {\n  viewModel: { createViewModel: viewModelFactory },\n  template: template\n};\n","import jQuery from 'jquery';\n\nconst template = `\n\n  <div class=\"ui checkbox\" data-bind=\"css: { disabled: disabled }\">\n    <input type=\"checkbox\" class=\"hidden\"\n      data-bind=\"checked: value, attr: { tabindex: tabindex }\">\n    <label data-bind=\"text: label\"></label>\n  </div>\n\n`;\n\nvar viewModelFactory = (params, componentInfo) => {\n  let element = componentInfo.element,\n      value = params.value,\n      disabled = params.disabled,\n      checkboxOpts = {\n        onChange: () => { value(!value()); }\n      },\n      popupOpts = {\n        content: params.disabledTooltip,\n        variation: 'basic',\n        position: 'right center',\n        transition: 'fade',\n        delay: {\n          show: 500,\n          hide: 0\n        },\n        duration: 400,\n        onVisible: function lazyHide(popupTarget) {\n          let hide = function (popupTarget) {\n            jQuery(popupTarget).popup('hide');\n          };\n          setTimeout(hide.bind(this, popupTarget), 1700);\n        }\n      };\n\n  if (disabled) {\n    jQuery(element).popup(popupOpts);\n  } else {\n    jQuery(element).checkbox(checkboxOpts);\n  }\n\n  return {\n    disabled: disabled,\n    label: params.label,\n    tabindex: params.tabindex,\n    value: value\n  };\n};\n\nexport default {\n  viewModel: { createViewModel: viewModelFactory },\n  template: template\n};\n","import jQuery from 'jquery';\nimport ko from 'knockout';\nimport { channels } from '../scripts/searchUnits.js';\n\nconst channelsHelp = `\n\n  <header class=\"ui header\">Единицы поиска</header>\n\n  <p>Чтобы выбрать единицу поиска, сначала укажите область разметки\n  в верхнем меню, а затем нажмите на нужный вам тип единицы.</p>\n\n`;\n\nconst disabledChannelHTML = `\n\n  <div style=\"font-size: smaller; font-style: italic\">\n    Аннотация пока не готова.\n  </div>\n\n`;\n\nconst unitTemplate = `\n\n  <li data-bind=\"click: $component.iHaveChosenUnitType.bind($data),\n                 css: { active: $component.node.unitType() &&\n                                $component.node.unitType().id === id }\">\n    <span class=\"unitSelectionContainer\">\n      <span class=\"unit\" data-bind=\"text: name\"></span>\n    </span>\n  </li>\n\n`;\n\nconst unitChoiceTemplate = `\n\n  <div>\n    <!-- ko foreach: channelViewModels -->\n    <button class=\"ui button bmpp-channelSlug\"\n      data-bind=\"css: buttonCSS, text: channel.id,\n        popup: tooltip, popupOpts: channelPopupOpts,\n        popupAdditionalShowOnClick: disabled,\n        event: { click: onClick, mouseover: onMouseOver,\n                 mouseout: onMouseOut }\">\n    </button>\n    <!-- /ko -->\n\n    <i class=\"disabled grey question circle outline icon bmpp-channelsHelp\"\n      data-bind=\"popup: channelsHelp.html, popupOpts: channelsHelp.opts\"></i>\n  </div>\n\n  <!-- ko if: activeChannel -->\n  <div data-bind=\"with: activeChannel\" style=\"margin-top: 2em\">\n    <header class=\"ui tiny header\"\n      data-bind=\"text: channel.unitsHeader\"></header>\n    <div style=\"column-count: 2\">\n\n      <!-- ko if: channel.groups -->\n      <ul class=\"bmpp-unitGroups\" data-bind=\"foreach: channel.groups\">\n        <li>\n          <header data-bind=\"text: name\"></header>\n          <ul class=\"bmpp-units\" data-bind=\"foreach: units\">\n            ${unitTemplate}\n          </ul>\n        </li>\n      </ul>\n      <!-- /ko -->\n\n      <!-- ko if: channel.units -->\n      <ul class=\"bmpp-units\" data-bind=\"foreach: channel.units\">\n        ${unitTemplate}\n      </ul>\n      <!-- /ko -->\n\n    </div>\n  </div>\n  <!-- /ko -->\n\n`;\n\nconst chosenUnitTemplate = `\n  <div>\n    <!-- ko with: activeChannel -->\n    <button class=\"ui button bmpp-channelSlug\"\n      data-bind=\"css: channel.color, text: channel.id,\n        popup: tooltip, popupOpts: channelPopupOpts\">\n    </button>\n    <!-- /ko -->\n    <span style=\"padding-left: .5em\">Тип единицы:</span>\n    <!-- ko with: node.unitType -->\n      <strong data-bind=\"text: hasAbbr ? abbr : name\"\n        style=\"padding-left: .5em\"></strong>\n    <!-- /ko -->\n    <div style=\"margin-top: 4em\">\n      <span data-bind=\"click: goEditUnitType\" class=\"bmpp-editUrl\">\n        Изменить тип единицы\n      </span>\n      <span data-bind=\"click: goEditUnitProperties\" class=\"bmpp-editUrl\"\n        style=\"margin-left: 1em\">\n        <span data-bind=\"text: isAnyUnitPropertySet() ? 'Изменить' : 'Задать'\">\n        </span> свойства единицы\n      </span>\n    </div>\n  </div>\n`;\n\nconst template = `\n\n  <!-- ko if: node.isEditStateForUnitType -->\n  ${unitChoiceTemplate}\n  <!-- /ko -->\n\n  <!-- ko ifnot: node.isEditStateForUnitType -->\n  ${chosenUnitTemplate}\n  <!-- /ko -->\n\n`;\n\nclass channelViewModel {\n  constructor(channel, activeChannel, iHaveChosenUnitType) {\n    let self = this;\n    this.channel = channel;\n    this.isActive = ko.computed(function() {\n      let aC = activeChannel();\n      return aC && aC.channel && aC.channel.id === self.channel.id;\n    });\n    this.isMouseOver = ko.observable(false);\n    this.onMouseOver = () => { self.isMouseOver(true); };\n    this.onMouseOut = () => { self.isMouseOver(false); };\n    this.disabled = (this.channel.disabled ||\n                     self.channel.totalNumberOfUnits === 0);\n    this.onClick = () => {\n      if (self.disabled) {\n        // Показать popup. NOTE: Это действие реализовано через свойство\n        // popupAdditionalShowOnClick пользовательского нокаут-байндинга popup.\n      } else if (self.channel.totalNumberOfUnits === 1) {\n        activeChannel(self);\n        iHaveChosenUnitType.call(self.channel.getSingleUnit());\n      } else {\n        activeChannel(self);\n      }\n    };\n    this.buttonCSS = ko.computed(function() {\n      let isActive = self.isActive(),\n          isMouseOver = self.isMouseOver(),\n          cssClasses;\n      if (activeChannel()) {\n        if (isActive || isMouseOver) {\n          cssClasses = self.channel.color;\n        } else {\n          cssClasses = `${self.channel.color} basic`;\n        }\n      } else {\n        cssClasses = self.channel.color;\n      }\n      return cssClasses;\n    });\n  }\n  get tooltip() {\n    if (this.disabled) return this.channel.name + disabledChannelHTML;\n    return this.channel.name;\n  }\n  get channelPopupOpts() {\n    return {\n      variation: 'basic',\n      delay: { show: 700, hide: 0 },\n      duration: 400,\n      transition: 'fade',\n      onVisible: function lazyHide(popupTarget) {\n        let hide = function (popupTarget) {\n          jQuery(popupTarget).popup('hide');\n        };\n        setTimeout(hide.bind(this, popupTarget), 1700);\n      }\n    };\n  }\n}\n\nclass viewModel {\n  constructor(params) {\n    let node = params.node,\n        prechoosenUnit = node.unitType(),\n        prechoosenChannel = prechoosenUnit && prechoosenUnit.channel,\n        activeChannel = ko.observable(null),\n        queryPartsNonReadiness = params.queryPartsNonReadiness,\n        goEditUnitType = function () {\n          node.isEditStateForUnitType(true);\n        },\n        goEditUnitProperties = function () {\n          params.editNodeProperties(node);\n        },\n        iHaveChosenUnitType = function () {\n          node.unitType(this);\n          node.isEditStateForUnitType(false);\n          params.isQueryNew(true);\n        },\n        iHaveChosenUnitProperties = function () {\n          params.finishEditingNodeProperties();\n          params.isQueryNew(true);\n        },\n        isAnyUnitPropertySet = ko.pureComputed(function () {\n          for (let prop of node.unitProperties()) {\n            if (prop.value() !== null) { return true; }\n          }\n          return false;\n        }).extend({ rateLimit: 500 }),\n        channelViewModels = [],\n        channelHelpPopupOpts = {\n          variation: 'basic',\n          delay: { show: 400, hide: 0 },\n          duration: 400,\n        };\n\n    queryPartsNonReadiness.push(node.isEditStateForUnitType);\n\n    for (let channel of channels) {\n      let cVM = new channelViewModel(channel, activeChannel, iHaveChosenUnitType);\n      channelViewModels.push(cVM);\n      if (prechoosenChannel && prechoosenChannel.id === channel.id) {\n        activeChannel(cVM);\n      }\n    }\n\n    if (!prechoosenUnit) {\n      goEditUnitType();\n    }\n\n    this.node = node;\n    this.channelViewModels = channelViewModels;\n    this.channelsHelp = { html: channelsHelp, opts: channelHelpPopupOpts };\n    this.activeChannel = activeChannel;\n    this.queryPartsNonReadiness = queryPartsNonReadiness;\n    this.goEditUnitType = goEditUnitType;\n    this.goEditUnitProperties = goEditUnitProperties;\n    this.iHaveChosenUnitType = iHaveChosenUnitType;\n    this.iHaveChosenUnitProperties = iHaveChosenUnitProperties;\n    this.isAnyUnitPropertySet = isAnyUnitPropertySet;\n  }\n  dispose() {\n    this.queryPartsNonReadiness.remove(this.node.isEditStateForUnitType);\n  }\n}\n\nexport default {\n  viewModel: viewModel,\n  template: template\n};\n","import ko from 'knockout';\n\nvar data = [\n\n  { type: 'interval', name: 'Длительность', id: 'duration',\n    help: '', units: 'миллисекунд', min: 0 },\n\n  { type: 'list', name: 'Участники', id: 'participants',\n    valueList: { orValues: [\n      { name: 'Рассказчик', value: 'N' },\n      { name: 'Комментатор', value: 'C' },\n      { name: 'Пересказчик', value: 'R' }\n    ]}\n  },\n\n  { type: 'list', name: 'Совпадение участников', id: 'same_participant',\n    valueList: { xorValues: [\n      { name: 'Да', value: true },\n      { name: 'Нет', value: false },\n    ]}\n  },\n\n  { type: 'text', name: 'Словарная форма', id: 'word' },\n\n  { type: 'interval', name: 'Позиция от начала ЭДЕ', id: 'n_from_edu',\n    min: 0 },\n\n  { type: 'list', name: 'Точка прерывания', id: 'p0',\n    valueList: { xorValues: [\n      { name: 'Да', orValues: [\n        { name: 'При самоисправлении внутри ЭДЕ', value: 'vx1' },\n        { name: 'При самоисправлении на границе ЭДЕ', value: 'vx2' },\n        { name: 'При вмешательстве внутри ЭДЕ', value: 'vx3' },\n        { name: 'При вмешательстве на границе ЭДЕ', value: 'vx4' },\n      ]},\n      { name: 'Нет', value: false },\n    ]}\n  },\n\n  { type: 'list', name: 'Иллокутивно-фазовое значение', id: 'iphv',\n    displayValues: true,\n    valueList: { orValues: [\n      { name: 'Иллокутивное', orValues: [\n        { name: 'Завершение сообщения', value: '.' },\n        { name: 'Вопрос', value: '?' },\n        { name: 'Директив', value: '¡' },\n        { name: 'Обращение', value: '@' },\n        { name: 'Полуутверждение', value: '¿' },\n        { name: 'Неполнота информации', value: '…' },\n        { name: 'Восклицательность', value: '¿' },\n      ]},\n      { name: 'Фазовое', orValues: [\n        { name: 'Стандартная незавершенность', value: ',' },\n        { name: 'Незавершенность, восполняемая последующим контекстом', value: ':' },\n        { name: 'Неполнота информации в контексте незавершенности', value: ',,,' },\n        { name: 'Начальная часть сплита', value: '—' },\n      ]},\n      { name: 'Обрыв', orValues: [\n        { name: 'При самоисправлении', value: '==' },\n        { name: 'При апосиопезе', value: '~' },\n        { name: 'При вмешательстве собеседника', value: '≈≈' },\n      ]},\n    ]}\n  },\n\n  { type: 'list', name: 'Фазовая структура', id: 'phs', displayValues: true,\n    valueList: { orValues: [\n      { name: 'Мах', value: 'S' },\n      { name: 'Мах, ретракция', value: 'S R' },\n      { name: 'Подготовка, мах', value: 'P S' },\n      { name: 'Подготовка, мах, ретракция', value: 'P S R' },\n      { name: 'Подготовка-мах', value: 'P-S' },\n      { name: 'Подготовка-мах, ретракция', value: 'P-S R' },\n      { name: 'Другой вариант', editable: true },\n    ]},\n    validChars: ['P', 'R', 'S', '-', ' '],\n    substitute: [\n      [/s/g, 'S'],\n      [/[pрР]/g, 'P'],\n      [/r/g, 'R'],\n      [/\\s+/g, ' '],\n      [/ -/g, '-'],\n      [/- /g, '-'],\n      [/^ /g, ''],\n      [/ $/g, ''],\n    ]\n  },\n\n  { type: 'list', name: 'С акцентом', id: 'with_accent', displayValues: true,\n    valueList: { xorValues: [\n      { name: 'Да', orValues: [\n        { name: 'С восходящим тоном', value: '/' },\n        { name: 'С нисходящим тоном', value: '\\\\' },\n        { name: 'С ровным тоном', value: '–' },\n        { name: 'С восходяще-нисходящим тоном', value: ['/\\\\', '/↓', '↑\\\\'] },\n        { name: 'С восходяще-ровным тоном', value: ['/–', '/→'] },\n        { name: 'С нисходяще-восходящим тоном', value: ['\\\\/', '\\\\↑'] },\n        { name: 'Другой вариант', editable: true },\n      ]},\n      { name: 'Нет', value: false },\n    ]},\n    virtualKeyboard: true,\n    validChars: ['/', '\\\\', '–', '↑', '↓', '→'],\n    substitute: [\n      [/[-\\u2014\\u2012]/g, '\\u2013'],\n    ]\n  },\n\n];\n\nclass SearchUnitProperty {\n  constructor(data) {\n    this.type = data.type;\n    this.id = data.id;\n    this.name = data.name;\n    this.help = data.help || '';\n    this.value = ko.observable(null);\n  }\n  static createByType(data) {\n    let map = {\n          'interval': IntervalProperty,\n          'text': TextProperty,\n          'list': ListProperty\n        },\n        Property = map[data.type];\n    if (Property) {\n      return new Property(data);\n    }\n  }\n}\n\nclass IntervalProperty extends SearchUnitProperty {\n  constructor(data) {\n    super(data);\n    this.units = data.units || '';\n    this.min = data.min;\n  }\n}\n\nclass TextProperty extends SearchUnitProperty {\n  constructor(data) {\n    super(data);\n  }\n}\n\nfunction escapeRegExp(string) {\n  return string.replace(/[.*+\\-?^${}()|[\\]\\\\]/g, '\\\\$&');\n}\n\nclass ListProperty extends SearchUnitProperty {\n  constructor(data) {\n    super(data);\n    this.valueList = data.valueList;\n    this.displayValues = data.displayValues || false;\n    this.virtualKeyboard = data.virtualKeyboard || false;\n    this.validChars = data.validChars;\n    this.validitySusbstitutions = this.getValueSubstitutions(data);\n  }\n  getValueSubstitutions(data) {\n    let substitutions = [];\n    if (data.substitute && data.substitute.length) {\n      substitutions = data.substitute;\n    }\n    if (data.validChars && data.validChars.length) {\n      let invalidChars = `[^${ escapeRegExp(data.validChars.join('')) }]`;\n      substitutions.push([new RegExp(invalidChars, 'g'), '']);\n    }\n    return substitutions;\n  }\n  makeValueValid(string) {\n    for (let i = 0; i < this.validitySusbstitutions.length; i++) {\n      let [ regexp, replacement ] = this.validitySusbstitutions[i];\n      string = string.replace(regexp, replacement);\n    }\n    return string;\n  }\n}\n\nexport {\n  data, SearchUnitProperty,\n  IntervalProperty, TextProperty, ListProperty\n};\n","import ko from 'knockout';\nimport { data as propertiesList, SearchUnitProperty } from './searchUnitProperties.js';\n\nexport class TreeNode {\n  constructor(parentNode=null, negative=false) {\n    this.parentNode = parentNode;\n    this.childNodes = ko.observableArray([]);\n    this.relationsToParentNode = ko.observableArray([]);\n\n    this.depth = ko.observable(parentNode && (parentNode.depth() + 1) || 0);\n    this.level = ko.observable(0);\n    this.serialNumber = ko.observable(0);\n    this.negative = ko.observable(negative);\n    this.unitType = ko.observable(null);\n    this.unitProperties = ko.observableArray([]);\n    this.isEditStateForUnitType = ko.observable(true);\n\n    this.tuneRelations();\n    this.tuneUnitProperties();\n  }\n  tuneRelations() {\n    if (this.parentNode !== null) {\n      this.addRelation();\n    }\n  }\n  tuneUnitProperties() {\n    let unitProperties = this.unitProperties;\n    this.unitType.subscribe(unitType => {\n      if (unitType === null) {\n        unitProperties([]);\n      }\n      // Сохраняем все свойства прежнего типа. Разбираемся, какой новый тип\n      // и канал пользователь выбрал.\n      let oldUnitTypeProperties = unitProperties(),\n          newUnitTypeProperties = [];\n      //    unitTypeId = unitType.id,\n      //    unitTypeChannel = unitType.channel;\n      //\n      // По типу поисковой единицы или/и каналу вытягиваем перечень\n      // свойств нового типа.\n      let unitTypePropertiesData = propertiesList;\n\n      // Создаем свойства нового типа, совпадающие свойства переиспользуем\n      // или создаем на основе соответствующего свойства прежнего типа\n      for (let i = 0; i < unitTypePropertiesData.length; i++) {\n        let newPropertyData = unitTypePropertiesData[i],\n            oldProperty = oldUnitTypeProperties.find(\n              unitType => unitType.id === newPropertyData.id\n            );\n        if (oldProperty) {\n          newUnitTypeProperties.push(oldProperty);\n        } else {\n          let newProperty = SearchUnitProperty.createByType(newPropertyData);\n          newUnitTypeProperties.push(newProperty);\n        }\n      }\n      unitProperties(newUnitTypeProperties);\n    });\n  }\n  addChild(negative=false) {\n    var child = new TreeNode(this, negative);\n    this.childNodes.push(child);\n  }\n  addRelation() {\n    this.relationsToParentNode.push(new NodesRelation(this.parentNode, this));\n  }\n  removeRelation(relation) {\n    this.relationsToParentNode.remove(relation);\n  }\n  seppuku() {\n    for (let childNode of this.childNodes()) {\n      childNode.seppuku();\n    }\n    this.relationsToParentNode.removeAll();\n    this.childNodes.removeAll();\n    this.parentNode.childNodes.remove(this);\n  }\n}\n\nexport class NodesRelation {\n  constructor(parentNode, childNode) {\n    this.parentNode = parentNode;\n    this.childNode = childNode;\n  }\n}\n","import ko from 'knockout';\n\nexport var records = [\n  { id: 'pears04', label: 'Pears 04', query: 4 },\n  { id: 'pears22', label: 'Pears 22', query: 22 },\n  { id: 'pears23', label: 'Pears 23', query: 23 },\n  { id: 'pears35', label: 'Pears 35', query: 35 },\n  { id: 'pears37', label: 'Pears 37', query: 37, disabled: true },\n  { id: 'pears39', label: 'Pears 39', query: 39, disabled: true }\n];\n\nexport var recordPhases = [\n  { id: 'narration', label: 'Рассказ', query: 'telling' },\n  { id: 'dialogue', label: 'Разговор', query: 'talk' },\n  { id: 'retelling', label: 'Пересказ', query: 'retelling' }\n];\n\nclass CheckboxField{\n  constructor(field, isSubcorpusNew) {\n    this.value = ko.observable(false);\n    this.id = field.id;\n    this.label = field.label;\n    this.disabled = Boolean(field.disabled);\n    this.query = field.query;\n\n    this.value.subscribe(() => {\n      isSubcorpusNew(true);\n    });\n  }\n}\n\nexport class CheckboxForm{\n  constructor(fields, isSubcorpusNew) {\n    let self = this;\n    this.fields = [];\n\n    for (let field of fields) {\n      this.fields.push(new CheckboxField(field, isSubcorpusNew));\n    }\n\n    this.invertSelection = () => {\n      for (let field of self.fields) {\n        if (!field.disabled) field.value(!field.value());\n      }\n    };\n    this.clearSelection = () => {\n      for (let field of self.fields) {\n        if (!field.disabled) field.value(false);\n      }\n    };\n  }\n  areAllUnchecked() {\n    for (let field of this.fields) {\n      if (!field.disabled && field.value()) return false;\n    }\n    return true;\n  }\n  getAllButDisabledQueryValues() {\n    let queryValues = [];\n    for (let field of this.fields) {\n      if (!field.disabled) {\n        queryValues.push(field.query);\n      }\n    }\n    return queryValues;\n  }\n  getAllCheckedQueryValues() {\n    let queryValues = [];\n    for (let field of this.fields) {\n      if (!field.disabled && field.value()) {\n        queryValues.push(field.query);\n      }\n    }\n    return queryValues;\n  }\n  getQueryValuesForJSON() {\n    if (this.areAllUnchecked()) return this.getAllButDisabledQueryValues();\n    return this.getAllCheckedQueryValues();\n  }\n}\n","/* eslint-disable */\nexport default {\n  \"version\": \"1.0\",\n  \"records\": [\n    {\n      \"record_id\": 22,\n      \"participant\": \"N\",\n      \"tier\": \"N-vSForm\",\n      \"annotation_index\": 20,\n      \"time\": {\n        \"begin\": 2200,\n        \"end\": 3740\n      },\n      \"left_context\": \"N-vE002\",\n      \"value\": \"Годов \\\\семидесятых я думаю.\",\n      \"right_context\": \"\"\n    },\n    {\n      \"record_id\": 22,\n      \"participant\": \"N\",\n      \"tier\": \"N-vSForm\",\n      \"annotation_index\": 20,\n      \"time\": {\n        \"begin\": 6010,\n        \"end\": 8490\n      },\n      \"left_context\": \"N-vE005\",\n      \"value\": \"(ˀ 0.06) (ɐ 0.53) Мы видим˗м сельский /–пейзаж,,,\",\n      \"right_context\": \"\"\n    },\n    {\n      \"record_id\": 22,\n      \"participant\": \"N\",\n      \"tier\": \"N-vSForm\",\n      \"annotation_index\": 20,\n      \"time\": {\n        \"begin\": 25640,\n        \"end\": 28380\n      },\n      \"left_context\": \"N-vE017\",\n      \"value\": \"у него (ɥ 0.29) на шее красный \\\\платок ↑завязан,\",\n      \"right_context\": \"\"\n    },\n    {\n      \"record_id\": 22,\n      \"participant\": \"N\",\n      \"tier\": \"N-vSForm\",\n      \"annotation_index\": 20,\n      \"time\": {\n        \"begin\": 50030,\n        \"end\": 52790\n      },\n      \"left_context\": \"N-vE027\",\n      \"value\": \"там уже \\\\стоят (0.13) (ɥ 0.26) \\\\парочка корзин /полных,\",\n      \"right_context\": \"\"\n    },\n    {\n      \"record_id\": 22,\n      \"participant\": \"N\",\n      \"tier\": \"N-vSForm\",\n      \"annotation_index\": 20,\n      \"time\": {\n        \"begin\": 65950,\n        \"end\": 68350\n      },\n      \"left_context\": \"N-vE034\",\n      \"value\": \"так всё очень не= || делает /нежно и \\\\любовноɯ.\",\n      \"right_context\": \"\"\n    },\n    {\n      \"record_id\": 22,\n      \"participant\": \"N\",\n      \"tier\": \"N-vSForm\",\n      \"annotation_index\": 20,\n      \"time\": {\n        \"begin\": 106370,\n        \"end\": 107350\n      },\n      \"left_context\": \"N-vE064\",\n      \"value\": \"велосипед /большой,\",\n      \"right_context\": \"\"\n    },\n    {\n      \"record_id\": 22,\n      \"participant\": \"N\",\n      \"tier\": \"N-vSForm\",\n      \"annotation_index\": 20,\n      \"time\": {\n        \"begin\": 107350,\n        \"end\": 108550\n      },\n      \"left_context\": \"N-vE065\",\n      \"value\": \"какие \\\\старые /советские,\",\n      \"right_context\": \"\"\n    },\n    {\n      \"record_id\": 22,\n      \"participant\": \"N\",\n      \"tier\": \"N-vSForm\",\n      \"annotation_index\": 20,\n      \"time\": {\n        \"begin\": 131450,\n        \"end\": 133380\n      },\n      \"left_context\": \"N-vE079\",\n      \"value\": \"видит \\\\фермер собирает там –груши,\",\n      \"right_context\": \"\"\n    },\n    {\n      \"record_id\": 22,\n      \"participant\": \"N\",\n      \"tier\": \"N-vSForm\",\n      \"annotation_index\": 20,\n      \"time\": {\n        \"begin\": 133380,\n        \"end\": 134920\n      },\n      \"left_context\": \"N-vE080\",\n      \"value\": \"полностью поглощён этим /занятием,\",\n      \"right_context\": \"\"\n    },\n    {\n      \"record_id\": 22,\n      \"participant\": \"N\",\n      \"tier\": \"N-vSForm\",\n      \"annotation_index\": 20,\n      \"time\": {\n        \"begin\": 151010,\n        \"end\": 152500\n      },\n      \"left_context\": \"N-vE090\",\n      \"value\": \"с этой тяжеленной /↑корзиной,\",\n      \"right_context\": \"\"\n    },\n    {\n      \"record_id\": 22,\n      \"participant\": \"N\",\n      \"tier\": \"N-vSForm\",\n      \"annotation_index\": 20,\n      \"time\": {\n        \"begin\": 192570,\n        \"end\": 193790\n      },\n      \"left_context\": \"N-vE117\",\n      \"value\": \"он один из них /приспускает,\",\n      \"right_context\": \"Произносит [прыспускает].\"\n    },\n    {\n      \"record_id\": 22,\n      \"participant\": \"N\",\n      \"tier\": \"N-vSForm\",\n      \"annotation_index\": 20,\n      \"time\": {\n        \"begin\": 228210,\n        \"end\": 230180\n      },\n      \"left_context\": \"N-vE136\",\n      \"value\": \"(ˀ 0.11) Они \\\\помогают ему /подняться=,\",\n      \"right_context\": \"\"\n    },\n    {\n      \"record_id\": 22,\n      \"participant\": \"N\",\n      \"tier\": \"N-vSForm\",\n      \"annotation_index\": 20,\n      \"time\": {\n        \"begin\": 230180,\n        \"end\": 231170\n      },\n      \"left_context\": \"N-vE137\",\n      \"value\": \"(ə 0.04) (\\\\Двое /помогают,\",\n      \"right_context\": \"Произносит [помогаюƟ].\"\n    },\n    {\n      \"record_id\": 22,\n      \"participant\": \"N\",\n      \"tier\": \"N-vSForm\",\n      \"annotation_index\": 20,\n      \"time\": {\n        \"begin\": 231170,\n        \"end\": 233480\n      },\n      \"left_context\": \"N-vE138\",\n      \"value\": \"/ˀодин так и сту= || и \\\\стучит своей этой \\\\↑штукой.)\",\n      \"right_context\": \"\"\n    },\n    {\n      \"record_id\": 22,\n      \"participant\": \"N\",\n      \"tier\": \"N-vSForm\",\n      \"annotation_index\": 20,\n      \"time\": {\n        \"begin\": 255660,\n        \"end\": 256960\n      },\n      \"left_context\": \"N-vE152\",\n      \"value\": \"/поднимают они ↑её,\",\n      \"right_context\": \"\"\n    },\n    {\n      \"record_id\": 22,\n      \"participant\": \"N\",\n      \"tier\": \"N-vSForm\",\n      \"annotation_index\": 20,\n      \"time\": {\n        \"begin\": 271630,\n        \"end\": 272320\n      },\n      \"left_context\": \"N-vE161\",\n      \"value\": \"взамен \\\\шляпы,\",\n      \"right_context\": \"\"\n    },\n    {\n      \"record_id\": 22,\n      \"participant\": \"N\",\n      \"tier\": \"N-vSForm\",\n      \"annotation_index\": 20,\n      \"time\": {\n        \"begin\": 445390,\n        \"end\": 447440\n      },\n      \"left_context\": \"N-vE238\",\n      \"value\": \"/Корзины прям просто под \\\\грушей /стоят,\",\n      \"right_context\": \"\"\n    },\n    {\n      \"record_id\": 22,\n      \"participant\": \"N\",\n      \"tier\": \"N-vSForm\",\n      \"annotation_index\": 20,\n      \"time\": {\n        \"begin\": 480570,\n        \"end\": 481360\n      },\n      \"left_context\": \"N-vE246\",\n      \"value\": \"Ничего не \\\\видно, \",\n      \"right_context\": \"\"\n    },\n    {\n      \"record_id\": 22,\n      \"participant\": \"N\",\n      \"tier\": \"N-vSForm\",\n      \"annotation_index\": 20,\n      \"time\": {\n        \"begin\": 596290,\n        \"end\": 597690\n      },\n      \"left_context\": \"N-vE289\",\n      \"value\": \"я бы \\\\свалилась точно.\",\n      \"right_context\": \"Второе слово произносит [салилась]. Последнее слово — шепотом.\"\n    },\n    {\n      \"record_id\": 22,\n      \"participant\": \"N\",\n      \"tier\": \"N-vSForm\",\n      \"annotation_index\": 20,\n      \"time\": {\n        \"begin\": 766410,\n        \"end\": 768090\n      },\n      \"left_context\": \"N-vE325\",\n      \"value\": \"Как˗к какая-то \\\\əшпанаɯ.\",\n      \"right_context\": \"\"\n    },\n    {\n      \"record_id\": 22,\n      \"participant\": \"N\",\n      \"tier\": \"N-vSForm\",\n      \"annotation_index\": 20,\n      \"time\": {\n        \"begin\": 770110,\n        \"end\": 772280\n      },\n      \"left_context\": \"N-vE326\",\n      \"value\": \"Ну /сначала как-то они \\\\подозрительно выглядят,\",\n      \"right_context\": \"\"\n    },\n    {\n      \"record_id\": 22,\n      \"participant\": \"N\",\n      \"tier\": \"N-vSForm\",\n      \"annotation_index\": 20,\n      \"time\": {\n        \"begin\": 772280,\n        \"end\": 773340\n      },\n      \"left_context\": \"N-vE327\",\n      \"value\": \"но /вообще \\\\нормально.\",\n      \"right_context\": \"\"\n    },\n    {\n      \"record_id\": 22,\n      \"participant\": \"N\",\n      \"tier\": \"N-vSForm\",\n      \"annotation_index\": 20,\n      \"time\": {\n        \"begin\": 773340,\n        \"end\": 774340\n      },\n      \"left_context\": \"N-vE328\",\n      \"value\": \"Они ему /помогают...\",\n      \"right_context\": \"\"\n    },\n    {\n      \"record_id\": 22,\n      \"participant\": \"N\",\n      \"tier\": \"N-vSForm\",\n      \"annotation_index\": 20,\n      \"time\": {\n        \"begin\": 801810,\n        \"end\": 802150\n      },\n      \"left_context\": \"N-vE329\",\n      \"value\": \"(ɯ 0.19) \\\\Да,\",\n      \"right_context\": \"\"\n    },\n    {\n      \"record_id\": 22,\n      \"participant\": \"N\",\n      \"tier\": \"N-vSForm\",\n      \"annotation_index\": 20,\n      \"time\": {\n        \"begin\": 802150,\n        \"end\": 803460\n      },\n      \"left_context\": \"N-vE330\",\n      \"value\": \"он /садится,\",\n      \"right_context\": \"\"\n    },\n    {\n      \"record_id\": 22,\n      \"participant\": \"N\",\n      \"tier\": \"N-vSForm\",\n      \"annotation_index\": 20,\n      \"time\": {\n        \"begin\": 803630,\n        \"end\": 805600\n      },\n      \"left_context\": \"N-vE331\",\n      \"value\": \"(ə 0.16) см= || смотрит свою /–коленку,,, ≈≈\",\n      \"right_context\": \"\"\n    },\n    {\n      \"record_id\": 22,\n      \"participant\": \"N\",\n      \"tier\": \"N-vSForm\",\n      \"annotation_index\": 20,\n      \"time\": {\n        \"begin\": 805600,\n        \"end\": 806230\n      },\n      \"left_context\": \"N-vE332\",\n      \"value\": \"Ну прямо \\\\так, \",\n      \"right_context\": \"\"\n    },\n    {\n      \"record_id\": 22,\n      \"participant\": \"N\",\n      \"tier\": \"N-vSForm\",\n      \"annotation_index\": 20,\n      \"time\": {\n        \"begin\": 806230,\n        \"end\": 807020\n      },\n      \"left_context\": \"N-vE333\",\n      \"value\": \"он /лежал сначала,\",\n      \"right_context\": \"\"\n    },\n    {\n      \"record_id\": 22,\n      \"participant\": \"N\",\n      \"tier\": \"N-vSForm\",\n      \"annotation_index\": 20,\n      \"time\": {\n        \"begin\": 841780,\n        \"end\": 843470\n      },\n      \"left_context\": \"N-vE343\",\n      \"value\": \"ˀОни ст= || \\\\поднимают ему всё это,\",\n      \"right_context\": \"\"\n    },\n    {\n      \"record_id\": 22,\n      \"participant\": \"N\",\n      \"tier\": \"N-vSForm\",\n      \"annotation_index\": 20,\n      \"time\": {\n        \"begin\": 928410,\n        \"end\": 928890\n      },\n      \"left_context\": \"N-vE364\",\n      \"value\": \"/Не- \\\\н˗не!,\",\n      \"right_context\": \"\"\n    },\n    {\n      \"record_id\": 22,\n      \"participant\": \"N\",\n      \"tier\": \"N-vSForm\",\n      \"annotation_index\": 20,\n      \"time\": {\n        \"begin\": 1092770,\n        \"end\": 1095300\n      },\n      \"left_context\": \"N-vE385\",\n      \"value\": \"мы /ничего˗оə || (0.40) уже не \\\\поправляем /никого.\",\n      \"right_context\": \"\"\n    }\n  ]\n};\n","import './styles/main.css';\nimport log from './scripts/log.js'; // eslint-disable-line no-unused-vars\n\nimport jQuery from 'jquery';\nimport ko from 'knockout';\nimport page from 'page';\nimport videojs from 'video.js';\n\nimport initKnockout from './scripts/init.knockout.js';\nimport { TreeNode } from './scripts/queryTree.js';\nimport getQueryJSON from './scripts/queryJSON.js';\n\nimport { records, recordPhases, CheckboxForm } from './scripts/subcorpus.js';\nimport resultsData from './results_data.js';\n\nvar videoPlayer = videojs('bmpp-videoPlayer');\n/* eslint-disable no-undef */\nconst searchEngineURL = (BUMPPO_ENV === 'production' ?\n        'http://multidiscourse.ru:8080/search_annotations/SearchAnnotations' :\n        'http://localhost:8080/search_annotations/SearchAnnotations'),\n      baseURL = (BUMPPO_ENV === 'production' ?\n        (BUMPPO_HOSTING ? '/bumppo-ghpages/BUMPPO_VERSION' : '/search/') : '');\n/* eslint-enable no-undef */\n\nfunction viewModel() {\n  let self = this;\n\n  this.queryPane = Symbol.for('query'),\n  this.subcorpusPane = Symbol.for('subcorpus'),\n  this.resultsPane = Symbol.for('results'),\n  this.resultsOptionsPane = Symbol.for('resoptions');\n  this.panes = [this.queryPane, this.subcorpusPane, this.resultsPane,\n                this.resultsOptionsPane];\n\n  this.activePane = ko.observable();\n  this.switchOnQueryPane = () => { self.activePane(self.queryPane); };\n  this.switchOnSubcorpusPane = () => { self.activePane(self.subcorpusPane); };\n  this.switchOnResultsPane = () => { self.activePane(self.resultsPane); };\n  this.switchOnResultsOptionsPane = () => {\n    self.activePane(self.resultsOptionsPane); };\n\n  this.isQueryPaneOn = ko.computed(\n    () => this.activePane() === self.queryPane);\n  this.isSubcorpusPaneOn = ko.computed(\n    () => this.activePane() === self.subcorpusPane);\n  this.isResultsPaneOn = ko.computed(\n    () => this.activePane() === self.resultsPane);\n  this.isResultsOptionsPaneOn = ko.computed(\n    () => this.activePane() === self.resultsOptionsPane);\n\n  ko.computed(() => {\n    var activePane = self.activePane();\n    if (activePane) {\n      page(`/${Symbol.keyFor(activePane)}`);\n      videoPlayer.pause();\n    }\n  });\n\n  this.queryPaneView = ko.observable(null);\n  this.queryPaneView.isTreeVisible = ko.computed(\n    () => self.queryPaneView() === null\n  );\n  this.queryPaneView.editNodeProperties = function (node) {\n    self.queryPaneView(node);\n  };\n  this.queryPaneView.finishEditingNodeProperties = function () {\n    self.queryPaneView(null);\n  };\n  this.queryPaneView.arePropertiesVisible = ko.computed(\n    () => self.queryPaneView() instanceof TreeNode\n  );\n  this.queryPaneView.propertiesNode = ko.computed(function () {\n    if (self.queryPaneView.arePropertiesVisible()) {\n      return self.queryPaneView.peek();\n    }\n  });\n\n  this.queryPartsNonReadiness = ko.observableArray(\n    [this.queryPaneView.arePropertiesVisible]);\n  this.isQueryReady = ko.computed(function () {\n    for (let isQueryPartNotReady of self.queryPartsNonReadiness()) {\n      if (isQueryPartNotReady()) { return false; }\n    }\n    if (!self.queryTree || !self.queryTree.unitType()) { return false; }\n    return true;\n  }).extend({ rateLimit: 50 });\n  this.isQueryNew = ko.observable(true);\n  this.isSubcorpusNew = ko.observable(false);\n\n  this.subcorpus = {\n    records: new CheckboxForm(records, this.isSubcorpusNew),\n    recordPhases: new CheckboxForm(recordPhases, this.isSubcorpusNew)\n  };\n\n  this.queryTree = new TreeNode();\n\n  this.canSearch = ko.computed(function () {\n    let isQueryReady = self.isQueryReady(),\n        isQueryNew = self.isQueryNew(),\n        isSubcorpusNew = self.isSubcorpusNew();\n    if (isQueryReady && (isQueryNew || isSubcorpusNew)) {\n      return true;\n    } else {\n      return false;\n    }\n  });\n\n  this.lastQueryJSON = '';\n  this.queryJSON = ko.computed(function () {\n    if (self.canSearch()) {\n      self.lastQueryJSON = getQueryJSON(self);\n    }\n    return self.lastQueryJSON;\n  }).extend({ rateLimit: 500 });\n\n  this.search = () => {\n    if (self.canSearch()) {\n      self.isSearchInProgress(true);\n      jQuery.ajax(searchEngineURL, {\n        data: {\n          data: window.encodeURIComponent(self.queryJSON())\n        }\n      }).done(data => {\n        self.isQueryNew(false);\n        self.isSubcorpusNew(false);\n        self.results(data);\n        self.resultsError(null);\n      }).fail((jqXHR, textStatus, errorThrown) => {\n        self.results(resultsData);\n        self.resultsError(`Ошибка: ${ textStatus } \"${ errorThrown }\"`);\n      }).always(() => {\n        self.isSearchInProgress(false);\n        self.canViewResults(true);\n        self.switchOnResultsPane();\n      });\n    }\n  };\n  this.isSearchInProgress = ko.observable(false);\n\n  this.canViewResults = ko.observable(false);\n  this.results = ko.observable(resultsData);\n  this.resultsError = ko.observable(null);\n  this.responseJSON = ko.computed(() => JSON.stringify(self.results(), null, 4));\n  this.playVideo = function (result) {\n    let { begin, end } = result.time,\n        pauseFunction = function () {\n          if (videoPlayer.currentTime() >= end) videoPlayer.pause();\n        };\n    begin /= 1000;\n    end /= 1000;\n    videoPlayer.currentTime(begin);\n    if (videoPlayer.pauseFunction !== undefined) {\n      videoPlayer.off('timeupdate', videoPlayer.pauseFunction);\n    }\n    videoPlayer.pauseFunction = pauseFunction;\n    videoPlayer.on('timeupdate', pauseFunction);\n    videoPlayer.play();\n  };\n\n}\nconst vM = new viewModel();\ninitKnockout(ko, vM);\n\n// Настройка клиентской маршрутизации\nconst queryURL = Symbol.keyFor(vM.queryPane),\n      subcorpusURL = Symbol.keyFor(vM.subcorpusPane),\n      resultsURL = Symbol.keyFor(vM.resultsPane),\n      resultsOptionsURL = Symbol.keyFor(vM.resultsOptionsPane);\n\npage.base(baseURL);\npage('/', () => { vM.activePane(vM.queryPane); });\npage(`/${queryURL}`, () => { vM.activePane(vM.queryPane); });\npage(`/${subcorpusURL}`, () => { vM.activePane(vM.subcorpusPane); });\npage(`/${resultsURL}`, () => {\n  if (vM.canViewResults()) {\n    vM.activePane(vM.resultsPane);\n  } else {\n    vM.activePane(vM.queryPane);\n  }\n});\npage(`/${resultsOptionsURL}`, () => { vM.activePane(vM.resultsOptionsPane); });\npage({ hashbang: true });\n\njQuery('.bmpp-sidePane_menuItem').mouseover(function () {\n  if (!jQuery(this).hasClass('disabled')) {\n    jQuery(this).addClass('bmpp-sidePane_menuItem--hover');\n  }\n});\njQuery('.bmpp-sidePane_menuItem').mouseout(function () {\n  jQuery(this).removeClass('bmpp-sidePane_menuItem--hover');\n});\n\nvideoPlayer.ready(function () {\n  var volume = videoPlayer.volume();\n  videoPlayer.volume(0);\n  videoPlayer.currentTime(0);\n  videoPlayer.pause();\n  videoPlayer.volume(volume);\n});\n","import linearizeTree from './linearizeTree.js';\n\nexport default function getQueryJSON(viewModel) {\n  let x = {\n        version: '1.0',\n        record_ids: viewModel.subcorpus.records.getQueryValuesForJSON(),\n        segments: viewModel.subcorpus.recordPhases.getQueryValuesForJSON(),\n        conditions: {\n        }\n      },\n      ltree = linearizeTree(viewModel.queryTree);\n  for (let i = 0; i < ltree.length; i++) {\n    let node = ltree[i],\n        simpleCond = {\n          type: 'simple',\n          is_regex: true,\n          search: '.+',\n          duration: []\n        };\n    simpleCond.tiers = ['N-vSForm', 'R-vSForm', 'C-vSForm'];\n    x.conditions[node.serialNumber().toString()] = simpleCond;\n\n    if (i > 0) {\n      let n1 = node.parentNode,\n          n2 = node,\n          id1 = n1.serialNumber().toString(),\n          id2 = n2.serialNumber().toString(),\n          complexCond = {\n            first_condition_id: id1,\n            second_condition_id: id2,\n            is_same_tier: (n1.unitType().channel.id === n2.unitType().channel.id),\n            type: 'overlaps'\n          };\n      x.conditions[`${id1}.${id2}`] = complexCond;\n    }\n  }\n  return JSON.stringify(x, null, 4);\n}\n","import jQuery from 'jquery';\n\nimport QueryPane from '../ko.components/queryPane.js';\nimport SubcorpusPane from '../ko.components/subcorpusPane.js';\nimport PropertiesPane from '../ko.components/propertiesPane.js';\nimport QueryNode from '../ko.components/queryNode.js';\nimport QueryNodeRelations from '../ko.components/queryNodeRelations.js';\nimport Checkbox from '../ko.components/checkbox.js';\nimport SearchUnitChoice from '../ko.components/searchUnitChoice.js';\n\nexport default function init(ko, viewModel) {\n  ko.bindingHandlers.popup = {\n    init: function(element, valueAccessor, allBindings) {\n      let content = ko.unwrap(valueAccessor()),\n          opts = allBindings.get('popupOpts') || {};\n      opts.html = content;\n      jQuery(element).popup(opts);\n\n      // Дополнительное отображение всплывающего окна по щелчку\n      if (ko.unwrap(allBindings.get('popupAdditionalShowOnClick'))) {\n        jQuery(element).click(function () {\n          jQuery(element).popup('show');\n        });\n      }\n    }\n  };\n  ko.components.register('bmpp-checkbox', Checkbox);\n  ko.components.register('query-pane', QueryPane);\n  ko.components.register('subcorpus-pane', SubcorpusPane);\n  ko.components.register('properties-pane', PropertiesPane);\n  ko.components.register('query-node', QueryNode);\n  ko.components.register('query-node-relations', QueryNodeRelations);\n  ko.components.register('search-unit-choice', SearchUnitChoice);\n  ko.applyBindings(viewModel);\n}\n"],"names":["css","ref","insertAt","document","head","getElementsByTagName","style","createElement","type","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","s","m","h","d","w","y","val","options","length","str","String","match","exec","n","parseFloat","toLowerCase","parse","isNaN","long","ms","msAbs","Math","abs","plural","fmtLong","round","fmtShort","Error","JSON","stringify","name","isPlural","env","selectColor","namespace","hash","i","charCodeAt","createDebug","colors","prevTime","debug","args","enabled","self","curr","Number","Date","diff","prev","coerce","unshift","index","replace","format","formatter","formatters","call","splice","formatArgs","log","apply","useColors","color","destroy","extend","init","instances","push","indexOf","this","delimiter","toNamespace","regexp","toString","substring","default","stack","message","disable","namespaces","names","map","skips","join","enable","save","split","len","RegExp","substr","instance","test","humanize","require$$0","Object","keys","forEach","key","load","exports","console","module","c","lastC","storage","setItem","removeItem","error","r","getItem","process","DEBUG","window","__nwjs","navigator","userAgent","documentElement","WebkitAppearance","firebug","exception","table","parseInt","$1","localStorage","localstorage","j","v","isarray","Array","isArray","arr","prototype","pathToRegexp_1","pathToRegexp","parse_1","compile_1","tokensToFunction","tokensToFunction_1","tokensToRegExp_1","tokensToRegExp","PATH_REGEXP","res","tokens","path","escaped","offset","slice","prefix","capture","group","suffix","asterisk","repeat","optional","pattern","escapeGroup","matches","obj","data","token","segment","value","TypeError","encodeURIComponent","escapeString","attachKeys","re","flags","sensitive","strict","end","route","lastToken","endsWithSlash","groups","source","regexpToRegexp","parts","arrayToRegexp","stringToRegexp","compile","loaded","hasDocument","hasWindow","hasHistory","history","hasProcess","clickEvent","ontouchstart","isLocation","location","Page","callbacks","exits","current","_decodeURLComponents","_base","_strict","_running","_hashbang","clickHandler","bind","_onpopstate","page","fn","Route","arguments","middleware","start","Context","state","pageInstance","_page","_window","hashbang","pageBase","_getBase","canonicalPath","title","querystring","_decodeURLEncodedURIComponent","pathname","params","globalPage","opts","method","configure","decodeURLComponents","_popstate","popstate","_click","click","addEventListener","removeEventListener","base","loc","protocol","dispatch","url","search","stop","show","ctx","prevContext","handled","pushState","back","setTimeout","redirect","from","to","inst","e","nextEnter","href","nextExit","exit","_which","metaKey","ctrlKey","shiftKey","defaultPrevented","el","target","eventPath","composedPath","nodeName","toUpperCase","parentNode","svg","constructor","hasAttribute","getAttribute","link","_samePath","baseVal","sameOrigin","orig","preventDefault","readyState","undefined","event","which","button","_toURL","URL","anc","hostname","port","decodeURIComponent","replaceState","next","qsIndex","hasOwnProperty","createPage","pageFn","create","defineProperty","get","set","page_js","default_1","factory","linearizeTree","node","treeLinearForm","isFirstChild","depth","levels","serialNumber","mx","max","level","childNodes","viewModel","createViewModel","componentInfo","redrawTree","linearizedTree","treeNode","svgSlug","position","svgRelationLine","redrawLine","linearizedQueryTree","ko","computed","tree","queryTree","subscribe","MutationObserver","timeoutID","clearTimeout","observe","element","childList","subtree","attributes","characterData","attributeOldValue","characterDataOldValue","svgDraw","SVG","size","template","records","recordPhases","popupOpts","variation","delay","hide","duration","html","selector","jQuery","find","popup","subcorpusClearSelection","areAllUnchecked","clearSelection","Slug","draw","svgCircle","drawCircle","svgText","drawText","add","fineTune","circle","circRadius","attr","fill","stroke","cx","cy","text","_this","changeText","utils","domNodeDisposal","addDisposeCallback","dispose","y1","top","y2","parent","x","remove","RelationLine","drawLine","_this2","parentSlug","width","slug1","slug2","rh","height","calculatePath","plot","relationsElementHeight","s1","s2","b2","l1","l2","addUnitPopupOpts","transition","onVisible","popupTarget","ready","content","inline","setFluidWidth","lastResort","onShow","targetElement","initialize","dropdown","relations","relationsToParentNode","disabled","checkboxOpts","onChange","disabledTooltip","checkbox","label","tabindex","id","unitsHeader","types","abbr","Unit","channel","hasAbbr","Boolean","UnitGroup","units","totalNumberOfUnits","populateUnits","Channel","populateGroupsAndUnits","unitGroup","concat","g","channels","channelsHelp","unitTemplate","unitChoiceTemplate","channelViewModel","activeChannel","iHaveChosenUnitType","isActive","aC","isMouseOver","observable","onMouseOver","onMouseOut","onClick","getSingleUnit","buttonCSS","prechoosenUnit","unitType","prechoosenChannel","queryPartsNonReadiness","goEditUnitType","isEditStateForUnitType","isQueryNew","isAnyUnitPropertySet","pureComputed","unitProperties","rateLimit","channelViewModels","cVM","goEditUnitProperties","editNodeProperties","iHaveChosenUnitProperties","finishEditingNodeProperties","help","min","valueList","orValues","xorValues","displayValues","editable","validChars","substitute","virtualKeyboard","SearchUnitProperty","Property","IntervalProperty","TextProperty","ListProperty","validitySusbstitutions","getValueSubstitutions","substitutions","invalidChars","string","replacement","TreeNode","negative","observableArray","tuneRelations","tuneUnitProperties","addRelation","oldUnitTypeProperties","newUnitTypeProperties","unitTypePropertiesData","propertiesList","newPropertyData","oldProperty","newProperty","createByType","child","NodesRelation","relation","seppuku","removeAll","childNode","query","CheckboxField","field","isSubcorpusNew","CheckboxForm","fields","invertSelection","queryValues","getAllButDisabledQueryValues","getAllCheckedQueryValues","videoPlayer","videojs","searchEngineURL","BUMPPO_ENV","vM","queryPane","Symbol","for","subcorpusPane","resultsPane","resultsOptionsPane","panes","activePane","switchOnQueryPane","switchOnSubcorpusPane","switchOnResultsPane","switchOnResultsOptionsPane","isQueryPaneOn","isSubcorpusPaneOn","isResultsPaneOn","isResultsOptionsPaneOn","keyFor","pause","queryPaneView","isTreeVisible","arePropertiesVisible","propertiesNode","peek","isQueryReady","isQueryPartNotReady","subcorpus","canSearch","lastQueryJSON","queryJSON","version","record_ids","getQueryValuesForJSON","segments","conditions","ltree","simpleCond","is_regex","n1","n2","id1","id2","complexCond","first_condition_id","second_condition_id","is_same_tier","getQueryJSON","isSearchInProgress","ajax","done","results","resultsError","fail","jqXHR","textStatus","errorThrown","resultsData","always","canViewResults","responseJSON","playVideo","result","time","begin","pauseFunction","currentTime","off","on","play","bindingHandlers","valueAccessor","allBindings","unwrap","components","register","Checkbox","QueryPane","SubcorpusPane","PropertiesPane","QueryNode","QueryNodeRelations","SearchUnitChoice","applyBindings","queryURL","subcorpusURL","resultsURL","resultsOptionsURL","mouseover","hasClass","addClass","mouseout","removeClass","volume"],"mappings":"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IAEnB,WACe,eACE,SACP,4BACY,QACZ,OACG,WACF,qBAEO,gBACP,8CACQ,IAEnB,WACe,eACE,SACP,4BACY,QACZ,OACG,WACF,qBAEO,gBACP,6CACQ,6BAEnB,WACe,eACE,SACP,4BACY,QACZ,OACG,WACF,qBAEO,gBACP,yDACQ,IAEnB,WACe,eACE,SACP,4BACY,QACZ,OACG,WACF,qBAEO,gBACP,4CACQ,0BAEnB,WACe,eACE,SACP,4BACY,QACZ,OACG,WACF,qBAEO,gBACP,uEACQ,IAEnB,WACe,eACE,SACP,4BACY,QACZ,OACG,WACF,qBAEO,gBACP,oCACQ,IAEnB,WACe,eACE,SACP,4BACY,QACZ,OACG,WACF,qBAEO,gBACP,gCACQ,IAEnB,WACe,eACE,SACP,4BACY,QACZ,OACG,WACF,qBAEO,gBACP,0DACQ,IAEnB,WACe,eACE,SACP,4BACY,QACZ,OACG,WACF,qBAEO,gBACP,oCACQ,IAEnB,WACe,eACE,SACP,4BACY,QACZ,OACG,WACF,qBAEO,gBACP,wCACQ,kEAEnB,WACe,eACE,SACP,4BACY,QACZ,OACG,WACF,qBAEO,gBACP,0CACQ,IAEnB,WACe,eACE,SACP,4BACY,QACZ,OACG,WACF,qBAEO,gBACP,iEACQ,IAEnB,WACe,eACE,SACP,4BACY,QACZ,OACG,WACF,qBAEO,gBACP,wCACQ,IAEnB,WACe,eACE,SACP,4BACY,QACZ,OACG,WACF,qBAEO,gBACP,qCACQ,IAEnB,WACe,eACE,SACP,4BACY,QACZ,OACG,WACF,qBAEO,gBACP,+BACQ,IAEnB,WACe,eACE,SACP,4BACY,QACZ,OACG,WACF,qBAEO,gBACP,6BACQ,IAEnB,WACe,eACE,SACP,4BACY,QACZ,OACG,WACF,qBAEO,gBACP,6DACQ,IAEnB,WACe,eACE,SACP,4BACY,QACZ,OACG,WACF,qBAEO,gBACP,iCACQ,IAEnB,WACe,eACE,SACP,4BACY,QACZ,OACG,WACF,qBAEO,gBACP,mCACQ,IAEnB,WACe,eACE,SACP,4BACY,QACZ,OACG,WACF,qBAEO,gBACP,qDA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"}